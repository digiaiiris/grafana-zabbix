define(["react","lodash","@grafana/ui","@grafana/data","@emotion/css","@grafana/runtime","moment","app/core/utils/datemath","jquery","app/plugins/sdk","app/core/core_module","app/core/core","app/core/table_model","app/core/utils/kbn","app/core/config","angular"],(function(e,t,r,n,a,i,o,s,u,l,c,p,f,d,m,h){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=75)}([function(t,r){t.exports=e},function(e,r){e.exports=t},,function(e,t,r){"use strict";r.d(t,"x",(function(){return c})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return f})),r.d(t,"c",(function(){return m})),r.d(t,"v",(function(){return h})),r.d(t,"s",(function(){return g})),r.d(t,"m",(function(){return y})),r.d(t,"n",(function(){return b})),r.d(t,"i",(function(){return E})),r.d(t,"a",(function(){return T})),r.d(t,"e",(function(){return x})),r.d(t,"r",(function(){return I})),r.d(t,"q",(function(){return w})),r.d(t,"u",(function(){return A})),r.d(t,"h",(function(){return S})),r.d(t,"w",(function(){return P})),r.d(t,"b",(function(){return D})),r.d(t,"k",(function(){return O})),r.d(t,"t",(function(){return R})),r.d(t,"o",(function(){return _})),r.d(t,"p",(function(){return C})),r.d(t,"d",(function(){return F})),r.d(t,"j",(function(){return M})),r.d(t,"l",(function(){return k}));var n=r(1),a=r.n(n),i=r(11),o=r.n(i),s=r(4),u=r(7),l=r(6),c=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::(\w+))?}/g;function p(e,t){for(var r,n,i,o,s,u=t.substring(t.indexOf("[")+1,t.lastIndexOf("]")),l=(r=u,n=[],i=!1,o=!1,s="",a.a.forEach(r,(function(e){'"'===e&&o?s+=e:'"'===e&&i?i=!1:'"'!==e||i?"["!==e||i?"]"!==e||i?","!==e||i||o?s+=e:(n.push(s),s=""):o=!1:o=!0:i=!0})),n.push(s),n),c=l.length;c>=1;c--)e=e.replace("$"+c,l[c-1]);return e}function f(e){return a.a.forEach(e,(function(e){return e.item=e.name,e.name=p(e.item,e.key_),e})),e}var d=/{\$[A-Z0-9_\.]+}/g;function m(e){return d.test(e)}function h(e,t,r,n){var i=r?e.url:e.name,o=i.match(d);return a.a.forEach(o,(function(o){var s=a.a.filter(t,(function(i){if(i.hostid){if(r){var o=!1;return a.a.forEach(e.hosts,(function(e){var r=(n.find((function(t){return t.hostid===e.hostid}))||{}).parentTemplates.findIndex((function(e){return e.templateid===i.hostid&&i.value}))>-1,a=t.findIndex((function(t){return t.hostid===e.hostid&&t.value&&t.macro===i.macro}))>-1;(e.hostid===i.hostid&&i.value||r&&!a)&&(o=!0)})),o}return i.hostid===e.hostid}return!0})),u=a.a.find(s,{macro:o});if(u&&u.value){var l=u.value,c=new RegExp(function(e){return e=e.replace(/\$/,"\\$")}(o));i=i.replace(c,l)}})),i}function g(e){var t,r=[];a.a.each(function(e){var t;if(function(e){return/^\{.+\}$/.test(e)}(e)){var r=e.match(/\{[^\{\}]*\}|\{\/.*\/\}/g);t=a.a.map(r,(function(e){return a.a.trim(e,"{}")}))}else t=e.split(".");return t}(e),(function(e){"*"===e&&(e="/.*/"),r.push(e)}));var n=a.a.zipObject(["group","host","app","item"],r);switch(4===r.length&&"/.*/"===n.app&&(n.app=""),r.length){case 1:t=u.b.Group;break;case 2:t=u.b.Host;break;case 3:t=u.b.Application;break;case 4:t=u.b.Item}return{queryType:t,group:n.group||"",host:n.host||"",application:n.app||"",item:n.item||""}}var v=/^\/(.*)\/([gmi]*)$/m;function y(e){return v.test(e)}function b(e,t){if(/^\$\w+/.test(e)){var r=a.a.map(t,(function(e){return"$"+e.name}));return a.a.includes(r,e)}return!1}function E(e){var t=e.to.diff(e.from),r=Math.round(t/1e3),n=l.rangeUtil.secondsToHms(t/1e3);return{__range_ms:{text:t,value:t},__range_s:{text:r,value:r},__range:{text:n,value:n},__range_series:{text:s.k,value:s.k}}}function T(e){var t=e.match(v),r=t[1],n=""!==t[2]?t[2]:void 0;return new RegExp(r,n)}function x(e){return e.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")}function I(e){var t=function(e){var t=/(^[\d]+)(y|M|w|d|h|m|s)?/g.exec(e);if(!t||!e||t.length>2&&!t[2])return"";return t[1]+(t.length>2?t[2]:"s")}(e);return t?w(t):0}function w(e){var t=/(^[\d]+)(y|M|w|d|h|m|s)/g.exec(e);return o.a.duration(Number(t[1]),t[2]).valueOf()}function A(e){var t=/^([\+\-]*)([\d]+)(y|M|w|d|h|m|s)/g.exec(e);return"+"===t[1]?0-o.a.duration(Number(t[2]),t[3]).valueOf():o.a.duration(Number(t[2]),t[3]).valueOf()}function S(e){if(e.length){var t="<br><br>Acknowledges:<br><table><tr><td><b>Time</b></td><td><b>User</b></td><td><b>Comments</b></td></tr>";return a.a.each(a.a.map(e,(function(e){return"<tr><td><i>"+o.a.unix(e.clock).format("DD MMM YYYY HH:mm:ss")+"</i></td><td>"+e.alias+" ("+e.name+" "+e.surname+")</td><td>"+e.message+"</td></tr>"})),(function(e){t=t.concat(e)})),t=t.concat("</table>")}return""}function P(e){return function(t){for(var r=0;r<e.length;r++)t=e[r].call(this,t);return t}}function D(e){return e.replace(/\s+/g," ").trim()}function O(e){return!isNaN(parseFloat(e))&&isFinite(e)}function R(e){if(!e)return[];var t=a.a.map(e.split(","),(function(e){return e.trim()}));return t=a.a.map(t,(function(e){var t,r,n=e.split(":");return{tag:null===(t=n[0])||void 0===t?void 0:t.trim(),value:null===(r=n[1])||void 0===r?void 0:r.trim()}}))}function _(e){return e.value?e.tag+": "+e.value:e.tag}function C(e){return e||[]}var N={"%":"percent",b:"decbits",bps:"bps",B:"bytes",Bps:"binBps",uptime:"dtdhms",qps:"qps",iops:"iops",Hz:"hertz",V:"volt",C:"celsius",RPM:"rotrpm",dBm:"dBm"},L=function(){for(var e={},t=0,r=Object(l.getValueFormats)();t<r.length;t++)for(var n=0,a=r[t].submenu;n<a.length;n++){var i=a[n].value;e[i]=i}return e}();function F(e){var t=N[e];return t||(t=L[e]),t}function M(e,t){var r=e.valuemapid,n=null==t?void 0:t.find((function(e){return e.valuemapid===r}));return n?n.mappings.map((function(e,t){return{type:l.MappingType.ValueToText,options:{value:e.value,text:e.newvalue}}})):null}function k(e){return e.fields.length&&e.fields[0].type===l.FieldType.other&&"problems"===e.fields[0].config.custom.type}},function(e,t,r){"use strict";r.d(t,"m",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"g",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"i",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"j",(function(){return c})),r.d(t,"h",(function(){return p})),r.d(t,"r",(function(){return f})),r.d(t,"q",(function(){return d})),r.d(t,"n",(function(){return m})),r.d(t,"o",(function(){return h})),r.d(t,"p",(function(){return g})),r.d(t,"l",(function(){return v})),r.d(t,"d",(function(){return y})),r.d(t,"k",(function(){return b})),r.d(t,"c",(function(){return E}));var n="iiris-zabbix-problems-panel",a=0,i=1,o="0",s="1",u="2",l="3",c="4",p="5",f=0,d=1,m=2,h=4,g=8,v=[{val:0,text:"Not classified"},{val:1,text:"Information"},{val:2,text:"Warning"},{val:3,text:"Average"},{val:4,text:"High"},{val:5,text:"Disaster"}],y=3600,b="range_series",E=1001},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t,r){"use strict";var n,a;r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a})),function(e){e.Group="group",e.Host="host",e.Application="application",e.ItemTag="itemTag",e.Item="item",e.ItemValues="itemValues"}(n||(n={})),function(e){e.Problems="problems",e.Recent="recent",e.History="history"}(a||(a={}))},function(e,t){e.exports=a},function(e,t){e.exports=i},,function(e,t){e.exports=o},function(e,t,r){const n=r(26),{MAX_LENGTH:a,MAX_SAFE_INTEGER:i}=r(25),{re:o,t:s}=r(21),{compareIdentifiers:u}=r(31);class l{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof l){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof l)){if("string"==typeof e&&e===this.version)return 0;e=new l(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof l||(e=new l(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],a=e.prerelease[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}compareBuild(e){e instanceof l||(e=new l(e,this.options));let t=0;do{const r=this.build[t],a=e.build[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=l},function(e,t,r){"use strict";r.d(t,"c",(function(){return u})),r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var n=r(1),a=r.n(n),i=r(11),o=r.n(i),s=r(3);function u(e,t){try{var r=s.q(t);return Date.now()-1e3*e.timestamp<r}catch(e){return!1}}function l(e,t){var r=t||"DD MMM YYYY HH:mm:ss";return o.a.unix(e).format(r)}var c=function(e){return a.a.find("ABCDEFGHIJKLMNOPQRSTUVWXYZ",(function(t){return a.a.every(e,(function(e){return e.refId!==t}))}))}},function(e,t){e.exports=s},function(e,t){e.exports=u},function(e,t,r){const n=r(12);e.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},function(e,t,r){class n{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=this.options.loose;e=e.trim();const r=t?s[u.HYPHENRANGELOOSE]:s[u.HYPHENRANGE];e=e.replace(r,I(this.options.includePrerelease)),i("hyphen replace",e),e=e.replace(s[u.COMPARATORTRIM],l),i("comparator trim",e,s[u.COMPARATORTRIM]),e=(e=(e=e.replace(s[u.TILDETRIM],c)).replace(s[u.CARETTRIM],p)).split(/\s+/).join(" ");const n=t?s[u.COMPARATORLOOSE]:s[u.COMPARATOR];return e.split(" ").map(e=>d(e,this.options)).join(" ").split(/\s+/).map(e=>x(e,this.options)).filter(this.options.loose?e=>!!e.match(n):()=>!0).map(e=>new a(e,this.options))}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>f(r,t)&&e.set.some(e=>f(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(w(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const a=r(28),i=r(26),o=r(12),{re:s,t:u,comparatorTrimReplace:l,tildeTrimReplace:c,caretTrimReplace:p}=r(21),f=(e,t)=>{let r=!0;const n=e.slice();let a=n.pop();for(;r&&n.length;)r=n.every(e=>a.intersects(e,t)),a=n.pop();return r},d=(e,t)=>(i("comp",e,t),e=v(e,t),i("caret",e),e=h(e,t),i("tildes",e),e=b(e,t),i("xrange",e),e=T(e,t),i("stars",e),e),m=e=>!e||"x"===e.toLowerCase()||"*"===e,h=(e,t)=>e.trim().split(/\s+/).map(e=>g(e,t)).join(" "),g=(e,t)=>{const r=t.loose?s[u.TILDELOOSE]:s[u.TILDE];return e.replace(r,(t,r,n,a,o)=>{let s;return i("tilde",e,t,r,n,a,o),m(r)?s="":m(n)?s=`>=${r}.0.0 <${+r+1}.0.0-0`:m(a)?s=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:o?(i("replaceTilde pr",o),s=`>=${r}.${n}.${a}-${o} <${r}.${+n+1}.0-0`):s=`>=${r}.${n}.${a} <${r}.${+n+1}.0-0`,i("tilde return",s),s})},v=(e,t)=>e.trim().split(/\s+/).map(e=>y(e,t)).join(" "),y=(e,t)=>{i("caret",e,t);const r=t.loose?s[u.CARETLOOSE]:s[u.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(t,r,a,o,s)=>{let u;return i("caret",e,t,r,a,o,s),m(r)?u="":m(a)?u=`>=${r}.0.0${n} <${+r+1}.0.0-0`:m(o)?u="0"===r?`>=${r}.${a}.0${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.0${n} <${+r+1}.0.0-0`:s?(i("replaceCaret pr",s),u="0"===r?"0"===a?`>=${r}.${a}.${o}-${s} <${r}.${a}.${+o+1}-0`:`>=${r}.${a}.${o}-${s} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${o}-${s} <${+r+1}.0.0-0`):(i("no pr"),u="0"===r?"0"===a?`>=${r}.${a}.${o}${n} <${r}.${a}.${+o+1}-0`:`>=${r}.${a}.${o}${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${o} <${+r+1}.0.0-0`),i("caret return",u),u})},b=(e,t)=>(i("replaceXRanges",e,t),e.split(/\s+/).map(e=>E(e,t)).join(" ")),E=(e,t)=>{e=e.trim();const r=t.loose?s[u.XRANGELOOSE]:s[u.XRANGE];return e.replace(r,(r,n,a,o,s,u)=>{i("xRange",e,r,n,a,o,s,u);const l=m(a),c=l||m(o),p=c||m(s),f=p;return"="===n&&f&&(n=""),u=t.includePrerelease?"-0":"",l?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&f?(c&&(o=0),s=0,">"===n?(n=">=",c?(a=+a+1,o=0,s=0):(o=+o+1,s=0)):"<="===n&&(n="<",c?a=+a+1:o=+o+1),"<"===n&&(u="-0"),r=`${n+a}.${o}.${s}${u}`):c?r=`>=${a}.0.0${u} <${+a+1}.0.0-0`:p&&(r=`>=${a}.${o}.0${u} <${a}.${+o+1}.0-0`),i("xRange return",r),r})},T=(e,t)=>(i("replaceStars",e,t),e.trim().replace(s[u.STAR],"")),x=(e,t)=>(i("replaceGTE0",e,t),e.trim().replace(s[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),I=e=>(t,r,n,a,i,o,s,u,l,c,p,f,d)=>`${r=m(n)?"":m(a)?`>=${n}.0.0${e?"-0":""}`:m(i)?`>=${n}.${a}.0${e?"-0":""}`:o?">="+r:`>=${r}${e?"-0":""}`} ${u=m(l)?"":m(c)?`<${+l+1}.0.0-0`:m(p)?`<${l}.${+c+1}.0-0`:f?`<=${l}.${c}.${p}-${f}`:e?`<${l}.${c}.${+p+1}-0`:"<="+u}`.trim(),w=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(i(e[r].semver),e[r].semver!==a.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},function(e,t){e.exports=l},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n=r(1),a=r.n(n),i=r(13),o=r(7),s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},u=8;function l(e){var t;if(function(e){return e.targets&&1===e.targets.length&&function(e){var t,r,n,a;return!((null===(t=e.group)||void 0===t?void 0:t.filter)||(null===(r=e.host)||void 0===r?void 0:r.filter)||(null===(n=e.application)||void 0===n?void 0:n.filter)||(null===(a=e.trigger)||void 0===a?void 0:a.filter)||e.queryType)}(e.targets[0])}(e))return e;if(function(e){return!e.datasource&&!e.datasources&&!e.triggers&&(t=e.targets,!t||a.a.isArray(t)&&(0===t.length||1===t.length&&a.a.isEmpty(t[0])));var t}(e))return delete e.targets,e;var r=function(e){return e.schemaVersion||1}(e);if(r<2&&(e.datasources=[e.datasource],e.targets={},e.targets[e.datasources[0]]=e.triggers,delete e.triggers,delete e.datasource),r<3&&(delete e.lastChangeField,delete e.infoField,delete e.scroll,delete e.hideHostsInMaintenance),r<5&&e.targets&&!a.a.isEmpty(e.targets)&&a.a.each(e.targets,(function(e){var t;a.a.defaultsDeep(e,{group:{filter:""},host:{filter:""},application:{filter:""},trigger:{filter:""},tags:{filter:""},proxy:{filter:""},refId:Object(i.b)(t)})})),r<6&&e.showEvents&&"1"===e.showEvents.value&&(e.showEvents.value=1),r<7){var n=[];for(var o in e.targets){f(g=e.targets[o])||d(g,o)||n.push(s(s({},g),{datasource:o}))}for(var u=0,l=n;u<l.length;u++){(g=l[u]).refId||(g.refId=Object(i.b)(n))}e.targets=n,delete e.datasources}if(r<8){1===e.targets.length?e.targets[0].datasource&&(e.datasource=e.targets[0].datasource,delete e.targets[0].datasource):e.targets.length>1&&(e.datasource="-- Mixed --");for(var m=0,h=e.targets;m<h.length;m++){var g;(g=h[m]).queryType=5,g.showProblems=p(e),g.options=c(e),a.a.defaults(g.options,{hostsInMaintenance:!0}),a.a.defaults(g,{tags:{filter:""}})}e.sortProblems="priority"===(null===(t=e.sortTriggersBy)||void 0===t?void 0:t.value)?"priority":"lastchange",delete e.showEvents,delete e.showTriggers,delete e.hostsInMaintenance,delete e.sortTriggersBy}return e}function c(e){var t,r=2;"acknowledged"===e.showTriggers?r=1:"unacknowledged"===e.showTriggers&&(r=0);var n=1001;return e.limit&&100!==e.limit&&(n=e.limit),{hostsInMaintenance:e.hostsInMaintenance,sortProblems:"priority"===(null===(t=e.sortTriggersBy)||void 0===t?void 0:t.value)?"priority":"default",minSeverity:0,acknowledged:r,limit:n}}function p(e){var t,r,n,a;return 1===(null===(t=e.showEvents)||void 0===t?void 0:t.value)?o.a.Problems:0===(null===(r=e.showEvents)||void 0===r?void 0:r.value)||(null===(a=null===(n=e.showEvents)||void 0===n?void 0:n.value)||void 0===a?void 0:a.length)>1?o.a.History:o.a.Problems}function f(e){return!e||!(e.group&&e.host&&e.application&&e.trigger)}function d(e,t){return e&&"A"===e.refId&&"0"===t}},function(e,t,r){const n=r(21);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:r(25).SEMVER_SPEC_VERSION,SemVer:r(12),compareIdentifiers:r(31).compareIdentifiers,rcompareIdentifiers:r(31).rcompareIdentifiers,parse:r(22),valid:r(46),clean:r(47),inc:r(48),diff:r(49),major:r(50),minor:r(51),patch:r(52),prerelease:r(53),compare:r(16),rcompare:r(54),compareLoose:r(55),compareBuild:r(33),sort:r(56),rsort:r(57),gt:r(27),lt:r(34),eq:r(32),neq:r(41),gte:r(35),lte:r(36),cmp:r(42),coerce:r(58),Comparator:r(28),Range:r(17),satisfies:r(29),toComparators:r(59),maxSatisfying:r(60),minSatisfying:r(61),minVersion:r(62),validRange:r(63),outside:r(37),gtr:r(64),ltr:r(65),intersects:r(66),simplifyRange:r(67),subset:r(68)}},function(e,t,r){const{MAX_SAFE_COMPONENT_LENGTH:n}=r(25),a=r(26),i=(t=e.exports={}).re=[],o=t.src=[],s=t.t={};let u=0;const l=(e,t,r)=>{const n=u++;a(n,t),s[e]=n,o[n]=t,i[n]=new RegExp(t,r?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),l("FULL",`^${o[s.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),l("LOOSE",`^${o[s.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",o[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),l("XRANGEIDENTIFIER",o[s.NUMERICIDENTIFIER]+"|x|X|\\*"),l("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),l("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),l("COERCERTL",o[s.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,r){const{MAX_LENGTH:n}=r(25),{re:a,t:i}=r(21),o=r(12);e.exports=(e,t)=>{if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof o)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?a[i.LOOSE]:a[i.FULL]).test(e))return null;try{return new o(e,t)}catch(e){return null}}},,,function(e,t){const r=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:r,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t){const r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=r},function(e,t,r){const n=r(16);e.exports=(e,t,r)=>n(e,t,r)>0},function(e,t,r){const n=Symbol("SemVer ANY");class a{static get ANY(){return n}constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof a){if(e.loose===!!t.loose)return e;e=e.value}u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?i[o.COMPARATORLOOSE]:i[o.COMPARATOR],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new l(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return s(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof a))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new c(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new c(this.value,t).test(e.semver);const r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),u=s(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=s(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||n||i&&o||u||l}}e.exports=a;const{re:i,t:o}=r(21),s=r(42),u=r(26),l=r(12),c=r(17)},function(e,t,r){const n=r(17);e.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},function(e,t){e.exports=c},function(e,t){const r=/^[0-9]+$/,n=(e,t)=>{const n=r.test(e),a=r.test(t);return n&&a&&(e=+e,t=+t),e===t?0:n&&!a?-1:a&&!n?1:e<t?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},function(e,t,r){const n=r(16);e.exports=(e,t,r)=>0===n(e,t,r)},function(e,t,r){const n=r(12);e.exports=(e,t,r)=>{const a=new n(e,r),i=new n(t,r);return a.compare(i)||a.compareBuild(i)}},function(e,t,r){const n=r(16);e.exports=(e,t,r)=>n(e,t,r)<0},function(e,t,r){const n=r(16);e.exports=(e,t,r)=>n(e,t,r)>=0},function(e,t,r){const n=r(16);e.exports=(e,t,r)=>n(e,t,r)<=0},function(e,t,r){const n=r(12),a=r(28),{ANY:i}=a,o=r(17),s=r(29),u=r(27),l=r(34),c=r(36),p=r(35);e.exports=(e,t,r,f)=>{let d,m,h,g,v;switch(e=new n(e,f),t=new o(t,f),r){case">":d=u,m=c,h=l,g=">",v=">=";break;case"<":d=l,m=p,h=u,g="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,f))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let o=null,s=null;if(n.forEach(e=>{e.semver===i&&(e=new a(">=0.0.0")),o=o||e,s=s||e,d(e.semver,o.semver,f)?o=e:h(e.semver,s.semver,f)&&(s=e)}),o.operator===g||o.operator===v)return!1;if((!s.operator||s.operator===g)&&m(e,s.semver))return!1;if(s.operator===v&&h(e,s.semver))return!1}return!0}},function(e,t){e.exports=p},function(e,t){e.exports=f},function(e,t){e.exports=d},function(e,t,r){const n=r(16);e.exports=(e,t,r)=>0!==n(e,t,r)},function(e,t,r){const n=r(32),a=r(41),i=r(27),o=r(35),s=r(34),u=r(36);e.exports=(e,t,r,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,l);case"!=":return a(e,r,l);case">":return i(e,r,l);case">=":return o(e,r,l);case"<":return s(e,r,l);case"<=":return u(e,r,l);default:throw new TypeError("Invalid operator: "+t)}}},function(e,t){e.exports=m},function(e,t){e.exports=h},,function(e,t,r){const n=r(22);e.exports=(e,t)=>{const r=n(e,t);return r?r.version:null}},function(e,t,r){const n=r(22);e.exports=(e,t)=>{const r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},function(e,t,r){const n=r(12);e.exports=(e,t,r,a)=>{"string"==typeof r&&(a=r,r=void 0);try{return new n(e,r).inc(t,a).version}catch(e){return null}}},function(e,t,r){const n=r(22),a=r(32);e.exports=(e,t)=>{if(a(e,t))return null;{const r=n(e),a=n(t),i=r.prerelease.length||a.prerelease.length,o=i?"pre":"",s=i?"prerelease":"";for(const e in r)if(("major"===e||"minor"===e||"patch"===e)&&r[e]!==a[e])return o+e;return s}}},function(e,t,r){const n=r(12);e.exports=(e,t)=>new n(e,t).major},function(e,t,r){const n=r(12);e.exports=(e,t)=>new n(e,t).minor},function(e,t,r){const n=r(12);e.exports=(e,t)=>new n(e,t).patch},function(e,t,r){const n=r(22);e.exports=(e,t)=>{const r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},function(e,t,r){const n=r(16);e.exports=(e,t,r)=>n(t,e,r)},function(e,t,r){const n=r(16);e.exports=(e,t)=>n(e,t,!0)},function(e,t,r){const n=r(33);e.exports=(e,t)=>e.sort((e,r)=>n(e,r,t))},function(e,t,r){const n=r(33);e.exports=(e,t)=>e.sort((e,r)=>n(r,e,t))},function(e,t,r){const n=r(12),a=r(22),{re:i,t:o}=r(21);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=i[o.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),i[o.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;i[o.COERCERTL].lastIndex=-1}else r=e.match(i[o.COERCE]);return null===r?null:a(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)}},function(e,t,r){const n=r(17);e.exports=(e,t)=>new n(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,r){const n=r(12),a=r(17);e.exports=(e,t,r)=>{let i=null,o=null,s=null;try{s=new a(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&-1!==o.compare(e)||(i=e,o=new n(i,r)))}),i}},function(e,t,r){const n=r(12),a=r(17);e.exports=(e,t,r)=>{let i=null,o=null,s=null;try{s=new a(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&1!==o.compare(e)||(i=e,o=new n(i,r)))}),i}},function(e,t,r){const n=r(12),a=r(17),i=r(27);e.exports=(e,t)=>{e=new a(e,t);let r=new n("0.0.0");if(e.test(r))return r;if(r=new n("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){e.set[t].forEach(e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!i(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}return r&&e.test(r)?r:null}},function(e,t,r){const n=r(17);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,r){const n=r(37);e.exports=(e,t,r)=>n(e,t,">",r)},function(e,t,r){const n=r(37);e.exports=(e,t,r)=>n(e,t,"<",r)},function(e,t,r){const n=r(17);e.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t))},function(e,t,r){const n=r(29),a=r(16);e.exports=(e,t,r)=>{const i=[];let o=null,s=null;const u=e.sort((e,t)=>a(e,t,r));for(const e of u){n(e,t,r)?(s=e,o||(o=e)):(s&&i.push([o,s]),s=null,o=null)}o&&i.push([o,null]);const l=[];for(const[e,t]of i)e===t?l.push(e):t||e!==u[0]?t?e===u[0]?l.push("<="+t):l.push(`${e} - ${t}`):l.push(">="+e):l.push("*");const c=l.join(" || "),p="string"==typeof t.raw?t.raw:String(t);return c.length<p.length?c:t}},function(e,t,r){const n=r(17),{ANY:a}=r(28),i=r(29),o=r(16),s=(e,t,r)=>{if(1===e.length&&e[0].semver===a)return 1===t.length&&t[0].semver===a;const n=new Set;let s,c,p,f,d,m,h;for(const t of e)">"===t.operator||">="===t.operator?s=u(s,t,r):"<"===t.operator||"<="===t.operator?c=l(c,t,r):n.add(t.semver);if(n.size>1)return null;if(s&&c){if(p=o(s.semver,c.semver,r),p>0)return null;if(0===p&&(">="!==s.operator||"<="!==c.operator))return null}for(const e of n){if(s&&!i(e,String(s),r))return null;if(c&&!i(e,String(c),r))return null;for(const n of t)if(!i(e,String(n),r))return!1;return!0}for(const e of t){if(h=h||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,s)if(">"===e.operator||">="===e.operator){if(f=u(s,e,r),f===e)return!1}else if(">="===s.operator&&!i(s.semver,String(e),r))return!1;if(c)if("<"===e.operator||"<="===e.operator){if(d=l(c,e,r),d===e)return!1}else if("<="===c.operator&&!i(c.semver,String(e),r))return!1;if(!e.operator&&(c||s)&&0!==p)return!1}return!(s&&m&&!c&&0!==p)&&!(c&&h&&!s&&0!==p)},u=(e,t,r)=>{if(!e)return t;const n=o(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},l=(e,t,r)=>{if(!e)return t;const n=o(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r)=>{e=new n(e,r),t=new n(t,r);let a=!1;e:for(const n of e.set){for(const e of t.set){const t=s(n,e,r);if(a=a||null!==t,t)continue e}if(a)return!1}return!0}},,,,,,,function(e,t,r){"use strict";r.r(t);var n=r(6),a=r(9),i=r(1),o=r.n(i),s=r(43),u=r.n(s),l=r(38),c=r(14),p=r(3),f=r(4);function d(e){return e.resultFormat=e.resultFormat||"time_series",function(e){return(!e.mode||0===e.mode||2===e.mode)&&!(!(e.hostFilter||e.itemFilter||e.downsampleFunction||e.host&&e.host.host)||void 0!==e.item.filter||void 0!==e.host.filter)}(e=function(e){e.group&&Array.isArray(e.group)&&(e.group={filter:""});return e}(e))?function(e){return e.group.filter="*"===e.group.name?"/.*/":e.group.name,e.host.filter="*"===e.host.name?m(e.hostFilter):e.host.name,e.application.filter="*"===e.application.name?"":e.application.name,e.item.filter="All"===e.item.name?m(e.itemFilter):e.item.name,e}(e):(function(e){if(e.functions)for(var t=0,r=e.functions;t<r.length;t++){var n=r[t];n.def&&"percentil"===n.def.name&&(n.def.name="percentile")}}(e),function(e){var t;void 0===e.queryType&&("Metrics"===e.mode?e.queryType=f.g:void 0!==e.mode&&(e.queryType=e.mode,delete e.mode)),"number"==typeof e.queryType&&(e.queryType=null===(t=e.queryType)||void 0===t?void 0:t.toString())}(e),function(e){e.queryType!==f.f||e.slaInterval||(e.slaInterval="none")}(e),function(e){var t;"priority"===(null===(t=e.options)||void 0===t?void 0:t.sortProblems)&&(e.options.sortProblems="severity")}(e),function(e){var t,r;e.itemTag||(e.itemTag={filter:""},(null===(t=e.application)||void 0===t?void 0:t.filter)&&(e.itemTag.filter="Application: "+(null===(r=e.application)||void 0===r?void 0:r.filter)))}(e),e)}function m(e){return e?"/"+e+"/":"/.*/"}function h(e){if(e||(e={}),!function(e){if(e.dbConnection&&!o.a.isEmpty(e.dbConnection))return!0;if(e.schema&&e.schema<3)return!0;return!1}(e))return e;var t=e.schema||1;if(e.schema=3,t<2){var r=e.dbConnection||{};e.dbConnectionEnable=r.enable||!1,e.dbConnectionDatasourceId=r.datasourceId||null,delete e.dbConnection}return t<3&&(e.timeout=""===e.timeout?null:Number(e.timeout)),e}var g=[],v={Transform:[],Aggregate:[],Filter:[],Trends:[],Time:[],Alias:[],Special:[]};function y(e){e.params=e.params||[],e.defaultParams=e.defaultParams||[],e.category&&v[e.category].push(e),g[e.name]=e,g[e.shortName||e.name]=e}y({name:"groupBy",category:"Transform",params:[{name:"interval",type:"string"},{name:"function",type:"string",options:["avg","min","max","sum","count","median","first","last"]}],defaultParams:["1m","avg"]}),y({name:"scale",category:"Transform",params:[{name:"factor",type:"float",options:[100,.01,10,-1]}],defaultParams:[100]}),y({name:"offset",category:"Transform",params:[{name:"delta",type:"float",options:[-100,100]}],defaultParams:[100]}),y({name:"delta",category:"Transform",params:[],defaultParams:[]}),y({name:"rate",category:"Transform",params:[],defaultParams:[]}),y({name:"movingAverage",category:"Transform",params:[{name:"factor",type:"int",options:[6,10,60,100,600]}],defaultParams:[10]}),y({name:"exponentialMovingAverage",category:"Transform",params:[{name:"smoothing",type:"float",options:[6,10,60,100,600]}],defaultParams:[.2]}),y({name:"percentile",category:"Transform",params:[{name:"interval",type:"string"},{name:"percent",type:"float",options:[25,50,75,90,95,99,99.9]}],defaultParams:["1m",95]}),y({name:"removeAboveValue",category:"Transform",params:[{name:"number",type:"float"}],defaultParams:[0]}),y({name:"removeBelowValue",category:"Transform",params:[{name:"number",type:"float"}],defaultParams:[0]}),y({name:"transformNull",category:"Transform",params:[{name:"number",type:"float"}],defaultParams:[0]}),y({name:"aggregateBy",category:"Aggregate",params:[{name:"interval",type:"string"},{name:"function",type:"string",options:["avg","min","max","sum","count","median","first","last"]}],defaultParams:["1m","avg"]}),y({name:"sumSeries",category:"Aggregate",params:[],defaultParams:[]}),y({name:"percentileAgg",category:"Aggregate",params:[{name:"interval",type:"string"},{name:"percent",type:"float",options:[25,50,75,90,95,99,99.9]}],defaultParams:["1m",95]}),y({name:"top",category:"Filter",params:[{name:"number",type:"int"},{name:"value",type:"string",options:["avg","min","max","sum","count","median","first","last"]}],defaultParams:[5,"avg"]}),y({name:"bottom",category:"Filter",params:[{name:"number",type:"int"},{name:"value",type:"string",options:["avg","min","max","sum","count","median","first","last"]}],defaultParams:[5,"avg"]}),y({name:"sortSeries",category:"Filter",params:[{name:"direction",type:"string",options:["asc","desc"]}],defaultParams:["asc"]}),y({name:"trendValue",category:"Trends",params:[{name:"type",type:"string",options:["avg","min","max","sum","count"]}],defaultParams:["avg"]}),y({name:"timeShift",category:"Time",params:[{name:"interval",type:"string",options:["24h","7d","1M","+24h","-24h"]}],defaultParams:["24h"]}),y({name:"setAlias",category:"Alias",params:[{name:"alias",type:"string"}],defaultParams:[]}),y({name:"setAliasByRegex",category:"Alias",params:[{name:"aliasByRegex",type:"string"}],defaultParams:[]}),y({name:"replaceAlias",category:"Alias",params:[{name:"regexp",type:"string"},{name:"newAlias",type:"string"}],defaultParams:["/(.*)/","$1"]}),y({name:"consolidateBy",category:"Special",params:[{name:"type",type:"string",options:["avg","min","max","sum","count"]}],defaultParams:["avg"]}),o.a.each(v,(function(e,t){v[t]=o.a.sortBy(e,"name")}));var b=function(){function e(e,t){this.def=e,t?this.params=t:(this.params=[],this.params=e.defaultParams.slice(0)),this.updateText()}return e.prototype.bindFunction=function(e){var t=e[this.def.name];if(t){for(var r=t,n=void 0,a=0;a<this.params.length;a++)n=this.params[a],"int"!==this.def.params[a].type&&"float"!==this.def.params[a].type||(n=Number(n)),r=o.a.partial(r,n);return r}throw{message:"Method not found "+this.def.name}},e.prototype.render=function(e){var t=this,r=this.def.name+"(",n=o.a.map(this.params,(function(e,r){var n=t.def.params[r].type;return"int"===n||"float"===n||"value_or_series"===n||"boolean"===n||"int_or_interval"===n&&Object(p.k)(e)?e:"'"+e+"'"}));return e&&n.unshift(e),r+n.join(", ")+")"},e.prototype._hasMultipleParamsInString=function(e,t){return-1!==e.indexOf(",")&&(this.def.params[t+1]&&this.def.params[t+1].optional)},e.prototype.updateParam=function(e,t){var r=this;this._hasMultipleParamsInString(e,t)?o.a.each(e.split(","),(function(e,t){r.updateParam(e.trim(),t)})):(""===e&&this.def.params[t].optional?this.params.splice(t,1):this.params[t]=e,this.updateText())},e.prototype.updateText=function(){if(0!==this.params.length){var e=this.def.name+"(";e+=this.params.join(", "),e+=")",this.text=e}else this.text=this.def.name+"()"},e}();function E(e,t){if(o.a.isString(e)){if(!g[e])throw{message:"Method not found "+name};e=g[e]}return new b(e,t)}function T(){return v}function x(e,t){return new RegExp(t).exec(e)[0]}var I={timeShift:function(e,t){var r=p.u(e)/1e3;return o.a.map(t,(function(e){return e-r}))},setAlias:function(e,t){var r,i,o,s,u,l,c,p,f;if((null===(r=t.fields)||void 0===r?void 0:r.length)<=2){var d=t.fields.find((function(e){return e.name===n.TIME_SERIES_VALUE_FIELD_NAME}));return(null===(o=null===(i=null==d?void 0:d.config)||void 0===i?void 0:i.custom)||void 0===o?void 0:o.scopedVars)&&(e=Object(a.getTemplateSrv)().replace(e,null===(u=null===(s=null==d?void 0:d.config)||void 0===s?void 0:s.custom)||void 0===u?void 0:u.scopedVars)),d&&(d.config.displayNameFromDS=e),t.name=e,t}for(var m=0;m<t.fields.length;m++){var h=t.fields[m];h.type!==n.FieldType.time&&((null===(c=null===(l=null==h?void 0:h.config)||void 0===l?void 0:l.custom)||void 0===c?void 0:c.scopedVars)&&(e=Object(a.getTemplateSrv)().replace(e,null===(f=null===(p=null==h?void 0:h.config)||void 0===p?void 0:p.custom)||void 0===f?void 0:f.scopedVars)),h.config.displayNameFromDS=e)}return t},setAliasByRegex:function(e,t){var r,a,i;if((null===(r=t.fields)||void 0===r?void 0:r.length)<=2){var o=t.fields.find((function(e){return e.name===n.TIME_SERIES_VALUE_FIELD_NAME}));try{o&&(o.config.displayNameFromDS=x(null===(a=o.config)||void 0===a?void 0:a.displayNameFromDS,e)),t.name=x(t.name,e)}catch(e){console.error("Failed to apply RegExp:",(null==e?void 0:e.message)||e)}return t}for(var s=0,u=t.fields;s<u.length;s++){var l=u[s];if(l.type!==n.FieldType.time)try{l.config.displayNameFromDS=x(null===(i=l.config)||void 0===i?void 0:i.displayNameFromDS,e)}catch(e){console.error("Failed to apply RegExp:",(null==e?void 0:e.message)||e)}}return t},replaceAlias:function(e,t,r){var i,o,s,u,l,c,f,d;if(d=p.m(e)?p.a(e):e,(null===(i=r.fields)||void 0===i?void 0:i.length)<=2){var m=r.name.replace(d,t),h=r.fields.find((function(e){return e.name===n.TIME_SERIES_VALUE_FIELD_NAME}));return(null===(o=null==h?void 0:h.state)||void 0===o?void 0:o.scopedVars)&&(m=Object(a.getTemplateSrv)().replace(m,null===(s=null==h?void 0:h.state)||void 0===s?void 0:s.scopedVars)),h&&(h.config.displayNameFromDS=m),r.name=m,r}for(var g=0,v=r.fields;g<v.length;g++){var y=v[g];if(y.type!==n.FieldType.time){m=null===(l=null===(u=y.config)||void 0===u?void 0:u.displayNameFromDS)||void 0===l?void 0:l.replace(d,t);(null===(c=null==y?void 0:y.state)||void 0===c?void 0:c.scopedVars)&&m&&(m=Object(a.getTemplateSrv)().replace(m,null===(f=null==y?void 0:y.state)||void 0===f?void 0:f.scopedVars)),y.name=m||y.name}}return r}},w={get metricFunctions(){return I}},A=r(39),S=r.n(A),P=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n};function D(e,t,r,n){var a=o.a.groupBy(e,"itemid"),i=o.a.uniqBy(o.a.flatten(o.a.map(t,"hosts")),"hostid");return o.a.map(a,(function(e,a){var s=o.a.find(t,{itemid:a}),u=s.name,l={__zbx_item:{value:s.name},__zbx_item_name:{value:s.name},__zbx_item_key:{value:s.key_},__zbx_item_interval:{value:s.delay}};if(o.a.keys(i).length>0){var c=o.a.find(i,{hostid:s.hostid});l.__zbx_host={value:c.host},l.__zbx_host_name={value:c.name},o.a.keys(i).length>1&&r&&(u=c.name+": "+u)}return{target:u,datapoints:o.a.map(e,n),scopedVars:l,item:s}}))}function O(e,t){var r=t.value;return e.textFilter&&(r=R(t.value,e.textFilter,e.useCaptureGroups)),[r,1e3*t.clock+Math.round(t.ns/1e6)]}function R(e,t,r){var n=new RegExp(t).exec(e);return n?r?n[1]:n[0]:""}function _(e){return[Number(e.value),1e3*e.clock+Math.round(e.ns/1e6)]}function C(e,t){var r;switch(e){case"min":r=t.value_min;break;case"max":r=t.value_max;break;case"avg":r=t.value_avg;break;case"sum":r=t.value_avg*t.num;break;case"count":r=t.num;break;default:r=t.value_avg}return[Number(r),1e3*t.clock]}var N={handleHistory:function(e,t,r){return void 0===r&&(r=!0),D(e,t,r,_)},convertHistory:D,handleTrends:function(e,t,r,n){return void 0===n&&(n=!0),D(e,t,n,o.a.partial(C,r))},handleText:function(e,t,r,n){return void 0===n&&(n=!0),D(e,t,n,o.a.partial(O,r))},handleHistoryAsTable:function(e,t,r){var n=new S.a;n.addColumn({text:"Host"}),n.addColumn({text:"Item"}),n.addColumn({text:"Key"}),n.addColumn({text:"Last value"});var a=o.a.groupBy(e,"itemid");return o.a.each(t,(function(e){var t=a[e.itemid]||[],i=o.a.last(t),s=i?i.value:null;if(!r.options.skipEmptyValues||s&&""!==s){r.textFilter&&(s=R(s,r.textFilter,r.useCaptureGroups));var u=o.a.first(e.hosts);u=u?u.name:"",n.rows.push([u,e.name,e.key_,s])}})),n},handleSLAResponse:function(e,t,r){var n=r[e.serviceid].sla;if("status"===t.property){var a=parseInt(r[e.serviceid].status,10);return{target:e.name+" "+t.name,datapoints:[[a,1e3*n[0].to]]}}var i=void 0,o=[];for(i=0;i<n.length;i++)0===i&&o.push([n[i][t.property],1e3*n[i].from]),o.push([n[i][t.property],1e3*n[i].to]);return{target:e.name+" "+t.name,datapoints:o}},handleTriggersResponse:function(e,t,r){if(o.a.isArray(e)){var n=function(e){var t=o.a.uniq(o.a.flattenDeep(o.a.map(e,(function(e){return o.a.map(e.groups,"name")})))),r={};return o.a.each(t,(function(e){r[e]={0:0,1:0,2:0,3:0,4:0,5:0}})),o.a.each(e,(function(e){o.a.each(e.groups,(function(t){r[t.name][e.priority]++}))})),r}(e),a=o.a.map(t,"name"),i=new S.a;return i.addColumn({text:"Host group"}),o.a.each(o.a.orderBy(f.l,["val"],["desc"]),(function(e){i.addColumn({text:e.text})})),o.a.each(n,(function(e,t){if(o.a.includes(a,t)){var r=o.a.map(o.a.orderBy(o.a.toPairs(e),(function(e){return e[0]}),["desc"]),(function(e){return e[1]}));r=o.a.concat.apply(o.a,P([[t]],r)),i.rows.push(r)}})),i}var s=null;try{s=Number(e)}catch(e){console.log("Error when handling triggers count: ",e)}return{target:"triggers count",datapoints:[[s,1e3*r[1]]]}},sortTimeseries:function(e){return o.a.forEach(e,(function(e){e.datapoints=o.a.sortBy(e.datapoints,(function(e){return e[f.a]}))})),e},seriesToDataFrame:function(e,t,r,a){var i,o,s,u,l,c,d,m=e.datapoints,h=e.scopedVars,g=e.target,v=e.item,y={name:n.TIME_SERIES_TIME_FIELD_NAME,type:n.FieldType.time,config:{custom:{}},values:new n.ArrayVector(m.map((function(e){return e[f.a]})))};d=(n.FieldType.string,new n.ArrayVector(m.map((function(e){return e[f.b]}))));var b={name:n.TIME_SERIES_VALUE_FIELD_NAME,type:null!=a?a:n.FieldType.number,labels:{},config:{displayNameFromDS:g,custom:{}},values:d};if(h&&(y.config.custom={itemInterval:null===(i=h.__zbx_item_interval)||void 0===i?void 0:i.value},b.labels={host:null===(o=h.__zbx_host_name)||void 0===o?void 0:o.value,item:null===(s=h.__zbx_item)||void 0===s?void 0:s.value,item_key:null===(u=h.__zbx_item_key)||void 0===u?void 0:u.value},b.config.custom={itemInterval:null===(l=h.__zbx_item_interval)||void 0===l?void 0:l.value}),v){var E=p.d(v.units);E&&(console.log("Datasource: unit detected: "+E+" ("+v.units+")"),b.config.unit=E,"percent"===E&&(b.config.min=0,b.config.max=100));var T=p.j(v,r);T&&(null===(c=t.options)||void 0===c?void 0:c.useZabbixValueMapping)&&(console.log("Datasource: using Zabbix value mapping"),b.config.mappings=T)}var x=[y,b],I={name:g,refId:t.refId,fields:x,length:m.length};return new n.MutableDataFrame(I)},dataResponseToTimeSeries:function(e,t,r){var a,i=[];if(0===e.length)return[];for(var s=0,u=e;s<u.length;s++)for(var l=u[s],c=Object(n.dataFrameFromJSON)(l),f=Object(n.getTimeField)(c),d=f.timeField,m=f.timeIndex,h=0;h<c.fields.length;h++){var g=c.fields[h];if(h!==m&&g.values&&g.values.length){for(var v=[],y=0;y<g.values.length;y++){var b=g.values.get(y);null!==b&&v.push({time:d.values.get(y)/1e3,value:b})}var E=g.name,T=o.a.find(t,{itemid:E}),x=1e6*r.intervalMs,I=1e6*p.r(T.delay);0===(x=Math.max(x,I))&&(x=null);var w=T.name;(null===(a=T.hosts)||void 0===a?void 0:a.length)>0&&(w=T.hosts[0].name+": "+w);var A={ts:v,meta:{name:w,item:T,interval:x}};i.push(A)}}return i},itServiceResponseToTimeSeries:function(e,t){var r=[];if(0===e.length)return[];for(var n=0,a=e;n<a.length;n++){var i=a[n],o=[];if(i.datapoints){for(var s=i.datapoints,u=0;u<s.length;u++)o.push({time:s[u][1]/1e3,value:s[u][0]});var l=1e6*p.r(t);0===l&&(l=null);var c={ts:o,meta:{name:i.target,interval:null,item:{}}};r.push(c)}}return r},isConvertibleToWide:function(e){if(!e||e.length<2)return!1;var t=e[0].fields.find((function(e){return e.type===n.FieldType.time}));if(!t)return!1;for(var r=1;r<e.length;r++)for(var a=e[r].fields.find((function(e){return e.type===n.FieldType.time})),i=0;i<Math.min(e.length,2);i++)if(a.values.get(i)!==t.values.get(i))return!1;return!0},convertToWide:function(e){var t=function(e){for(var t=0,r=0,a=0;a<e.length;a++){var i=e[a].fields.find((function(e){return e.type===n.FieldType.time}));i.values.length>r&&(r=i.values.length,t=a)}return t}(e),r=e[t].fields.find((function(e){return e.type===n.FieldType.time}));if(!r)return[];for(var a=[r],i=0;i<e.length;i++){var o=e[i].fields.find((function(e){return e.name===n.TIME_SERIES_VALUE_FIELD_NAME}));o&&(o.name=e[i].name,r.values.length-o.values.length==1&&o.values.add(null),a.push(o))}return[{name:"wide",fields:a,length:r.values.length}]},alignFrames:function(e){var t;if(!e||0===e.length)return e;for(var r=e[0].fields.find((function(e){return e.name===n.TIME_SERIES_TIME_FIELD_NAME})).values.get(0),a=0;a<e.length;a++){(i=(s=e[a].fields.find((function(e){return e.name===n.TIME_SERIES_TIME_FIELD_NAME}))).values.get(0))<r&&(r=i)}for(a=0;a<e.length;a++){var i,o=e[a],s=o.fields.find((function(e){return e.name===n.TIME_SERIES_TIME_FIELD_NAME})),u=o.fields.find((function(e){return e.name===n.TIME_SERIES_VALUE_FIELD_NAME}));if((i=s.values.get(0))>r){console.log("Data frames: adding missing points");for(var l=s.values.toArray(),c=u.values.toArray(),p=[],f=[],d=null===(t=s.config.custom)||void 0===t?void 0:t.itemInterval,m=r;m<i;m+=d)p.push(m),f.push(null);l=p.concat(l),c=f.concat(c),s.values=new n.ArrayVector(l),u.values=new n.ArrayVector(c)}}return e},convertZabbixUnits:function(e){for(var t,r=0;r<e.data.length;r++)for(var n=0,a=e.data[r].fields;n<a.length;n++){var i=a[n],o=null===(t=i.config.custom)||void 0===t?void 0:t.units;if(o){var s=p.d(o);s&&(i.config.unit=s,"percent"===s&&(i.config.min=0,i.config.max=100))}}return e}};function L(e,t){for(var r=[],n=0;n<e.length;n++){var a=e[n],i=t[Number(a.objectid)];if(i){var o={timestamp:Number(a.clock),triggerid:a.objectid,eventid:a.eventid,name:a.name,severity:a.severity,acknowledged:a.acknowledged,acknowledges:a.acknowledges,tags:a.tags,suppressed:a.suppressed,suppression_data:a.suppression_data,description:a.name||i.description,comments:i.comments,value:i.value,groups:i.groups,hosts:i.hosts,items:i.items,alerts:i.alerts,url:i.url,expression:i.expression,correlation_mode:i.correlation_mode,correlation_tag:i.correlation_tag,manual_close:i.manual_close,state:i.state,error:i.error,opdata:i.opdata};r.push(o)}}return r}function F(e,t,r){for(var n=r.valueFromEvent,a=[],i=0;i<e.length;i++){var o=e[i],s=t[Number(o.objectid)];if(s){var u={value:n?o.value:s.value,timestamp:Number(o.clock),triggerid:o.objectid,eventid:o.eventid,name:o.name,severity:o.severity,acknowledged:o.acknowledged,acknowledges:o.acknowledges,tags:o.tags,suppressed:o.suppressed,description:s.description,comments:s.comments,groups:s.groups,hosts:s.hosts,items:s.items,alerts:s.alerts,url:s.url,expression:s.expression,correlation_mode:s.correlation_mode,correlation_tag:s.correlation_tag,manual_close:s.manual_close,state:s.state,error:s.error};a.push(u)}}return a}var M={addTriggerDataSource:function(e,t){return o.a.each(e,(function(e){e.datasource=t.datasource})),e},addTriggerHostProxy:function(e,t){return e.forEach((function(e){if(e.hosts&&e.hosts.length){var r=e.hosts[0];if("0"!==r.proxy_hostid){var n=t[r.proxy_hostid];r.proxy=n?n.host:""}}})),e},setMaintenanceStatus:function(e){return o.a.each(e,(function(e){var t=o.a.some(e.hosts,(function(e){return"1"===e.maintenance_status}));e.maintenance=t})),e},setAckButtonStatus:function(e,t){return o.a.each(e,(function(e){e.showAckButton=t})),e},filterTriggersPre:function(e,t){var r=t.trigger.filter;return r&&(e=function(e,t){return p.m(t)?o.a.filter(e,(function(e){return p.a(t).test(e.description)})):o.a.filter(e,(function(e){return e.description===t}))}(e,r)),t.options.hostsInMaintenance||(e=o.a.filter(e,(function(e){return!e.maintenance}))),e},sortProblems:function(e,t){var r,n;return"severity"===(null===(r=t.options)||void 0===r?void 0:r.sortProblems)?e=o.a.orderBy(e,["severity","eventid"],["desc","desc"]):"lastchange"===(null===(n=t.options)||void 0===n?void 0:n.sortProblems)&&(e=o.a.orderBy(e,["timestamp","eventid"],["desc","desc"])),e},toDataFrame:function(e){return{name:"problems",fields:[{name:"Problems",type:n.FieldType.other,values:new n.ArrayVector(e),config:{custom:{type:"problems"}}}],length:e.length}},joinTriggersWithProblems:L,joinTriggersWithEvents:F},k=r(11),$=r.n(k),q=r(20),j=r.n(q),V=function(){function e(e){this.cacheEnabled=e.enabled,this.ttl=e.ttl||6e5,this.cache={},this.promises={}}return e.prototype.cacheRequest=function(e,t,r){return function(e,t,r,n){return function(){n.cache[t]||(n.cache[t]={});var a=n.cache[t],i=B(arguments),o="getGroupsWithHosts"===t||"getMaintenances"===t;return n.cacheEnabled&&!n._isExpired(a[i],o)&&"forceCacheUpdate"!==arguments[0]?Promise.resolve(a[i].value):e.apply(r,arguments).then((function(e){return void 0!==e&&(a[i]={value:e,timestamp:Date.now()}),e}))}}(e,t,r,this)},e.prototype.proxify=function(e,t,r){return this.promises[t]||(this.promises[t]={}),function(e,t,r){return function(){var n=B(arguments);return t[n]||(t[n]=Promise.resolve(e.apply(r,arguments).then((function(e){return t[n]=null,e})).catch((function(e){throw t[n]=null,e})))),t[n]}}(e,this.promises[t],r)},e.prototype.proxifyWithCache=function(e,t,r){var n=this.proxify(e,t,r);return this.cacheRequest(n,t,r)},e.prototype._isExpired=function(e,t){if(e){var r=Date.now()-e.timestamp;return!(e.timestamp&&r<(t?6e4:this.ttl))}return!0},e}();function B(e){return function(e){var t,r,n,a=0;if(0!==e.length)for(t=0,n=e.length;t<n;t++)r=e.charCodeAt(t),a=(a<<5)-a+r,a|=0;return a}(JSON.stringify(e))}var H={0:"history",1:"history_str",2:"history_log",3:"history_uint",4:"history_text"},G={0:"trends",3:"trends_uint"},z={avg:"value_avg",min:"value_min",max:"value_max",sum:"num*value_avg"},U=function(){function e(e){this.datasourceId=e.datasourceId,this.datasourceName=e.datasourceName,this.datasourceTypeId=null,this.datasourceTypeName=null}return e.loadDatasource=function(e,t){if(!t&&void 0!==e){var r=o.a.find(Object(a.getDataSourceSrv)().getList(),{id:e});if(!r)return Promise.reject("Data Source with ID "+e+" not found");t=r.name}return t?Object(a.getDataSourceSrv)().get(t):Promise.reject("Data Source name should be specified")},e.prototype.loadDBDataSource=function(){var t=this;return e.loadDatasource(this.datasourceId,this.datasourceName).then((function(e){return t.datasourceTypeId=e.meta.id,t.datasourceTypeName=e.meta.name,t.datasourceName||(t.datasourceName=e.name),t.datasourceId||(t.datasourceId=e.id),e}))},e}(),Q={DBConnector:U,DEFAULT_QUERY_LIMIT:1e4,HISTORY_TO_TABLE_MAP:H,TREND_TO_TABLE_MAP:G,consolidateByFunc:{avg:"AVG",min:"MIN",max:"MAX",sum:"SUM",count:"COUNT"},consolidateByTrendColumns:z},W=r(40),X=r.n(W),Z=r(7),Y=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},J=function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},K=(null===n.rangeUtil||void 0===n.rangeUtil?void 0:n.rangeUtil.roundInterval)||X.a.roundInterval||X.a.round_interval,ee=function(){function e(e,t,r){this.datasourceId=r,this.backendAPIUrl="/api/datasources/"+this.datasourceId+"/resources/zabbix-api",this.requestOptions={basicAuth:e,withCredentials:t},this.getTrend=this.getTrend_ZBXNEXT1193,this.initVersion()}return e.prototype.request=function(e,t){var r=this;return this.version?this.backendAPIRequest(e,t):this.initVersion().then((function(){return r.request(e,t)}))},e.prototype.backendAPIRequest=function(e,t){var r;return void 0===t&&(t={}),Y(this,void 0,void 0,(function(){var n,i;return J(this,(function(o){switch(o.label){case 0:return n={url:this.backendAPIUrl,method:"POST",headers:{"Content-Type":"application/json"},hideFromInspector:!1,data:{datasourceId:this.datasourceId,method:e,params:t}},(this.requestOptions.basicAuth||this.requestOptions.withCredentials)&&(n.withCredentials=!0),this.requestOptions.basicAuth&&(n.headers.Authorization=this.requestOptions.basicAuth),[4,Object(a.getBackendSrv)().fetch(n).toPromise()];case 1:return i=o.sent(),[2,null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.result]}}))}))},e.prototype.getVersion=function(){return this.backendAPIRequest("apiinfo.version")},e.prototype.initVersion=function(){var e=this;return this.getVersionPromise||(this.getVersionPromise=Promise.resolve(this.getVersion().then((function(t){return t?console.log("Zabbix version detected: "+t):console.log("Failed to detect Zabbix version, use default 3.0.0"),e.version=t||"3.0.0",e.getVersionPromise=null,t})))),this.getVersionPromise},e.prototype.isZabbix54OrHigher=function(){return j.a.gte(this.version,"5.4.0")},e.prototype.acknowledgeEvent=function(e,t,r,n){r||(r=j.a.gte(this.version,"4.0.0")?f.o:f.r);var a={eventids:e,message:t,action:r};return void 0!==n&&(a.severity=n),this.request("event.acknowledge",a)},e.prototype.getGroupsWithHosts=function(){var e={selectHosts:["hostid","name","maintenance_status"],output:["groupid","name"],limit:Math.floor(1e3*Math.random())+1e3};return this.request("hostgroup.get",e)},e.prototype.getGroups=function(){return this.request("hostgroup.get",{output:["name"],sortfield:"name",real_hosts:!0})},e.prototype.getHosts=function(e){var t={output:["name","host"],sortfield:"name"};return e&&(t.groupids=e),this.request("host.get",t)},e.prototype.getApps=function(e){return Y(this,void 0,Promise,(function(){var t;return J(this,(function(r){return this.isZabbix54OrHigher()?[2,[]]:(t={output:"extend",hostids:e},[2,this.request("application.get",t)])}))}))},e.prototype.getItems=function(e,t,r){var n={output:["name","key_","value_type","hostid","status","state","units","valuemapid","delay"],sortfield:"name",webitems:!0,filter:{},selectHosts:["hostid","name","host"]};return e&&(n.hostids=e),t&&(n.applicationids=t),"num"===r&&(n.filter.value_type=[0,3]),"text"===r&&(n.filter.value_type=[1,2,4]),this.isZabbix54OrHigher()&&(n.selectTags="extend"),this.request("item.get",n).then(p.g)},e.prototype.getItemsByIDs=function(e){var t={itemids:e,output:["name","key_","value_type","hostid","status","state","units","valuemapid","delay"],webitems:!0,selectHosts:["hostid","name"]};return this.isZabbix54OrHigher()&&(t.selectTags="extend"),this.request("item.get",t).then((function(e){return p.g(e)}))},e.prototype.getHostsByIDs=function(e){var t={hostids:e,selectParentTemplates:["name","templateid"],output:["name","hostid"]};return this.request("host.get",t)},e.prototype.getMacros=function(e){var t={output:"extend",hostids:e};return this.request("usermacro.get",t)},e.prototype.getGlobalMacros=function(){return this.request("usermacro.get",{output:"extend",globalmacro:!0})},e.prototype.getLastValue=function(e){var t={output:["lastvalue"],itemids:e};return this.request("item.get",t).then((function(e){return e.length?e[0].lastvalue:null}))},e.prototype.getHistory=function(e,t,r){var n=this,a=o.a.groupBy(e,"value_type"),i=o.a.map(a,(function(e,a){var i={output:"extend",history:a,itemids:o.a.map(e,"itemid"),sortfield:"clock",sortorder:"ASC",time_from:t};return r&&(i.time_till=r),n.request("history.get",i)}));return Promise.all(i).then(o.a.flatten)},e.prototype.getTrend_ZBXNEXT1193=function(e,t,r){var n=this,a=o.a.groupBy(e,"value_type"),i=o.a.map(a,(function(e,a){var i={output:"extend",trend:a,itemids:o.a.map(e,"itemid"),sortfield:"clock",sortorder:"ASC",time_from:t};return r&&(i.time_till=r),n.request("trend.get",i)}));return Promise.all(i).then(o.a.flatten)},e.prototype.getTrend_30=function(e,t,r,n){var a={output:["itemid","clock",n],itemids:o.a.map(e,"itemid"),time_from:t};return r&&(a.time_till=r),this.request("trend.get",a)},e.prototype.getITService=function(e){var t={output:"extend",serviceids:e};return this.request("service.get",t)},e.prototype.getSLA=function(e,t,r){var n=[{from:t[0],to:t[1]}];if("auto"===r.slaInterval)n=re(t,te(r.intervalMs));else if("none"!==r.slaInterval){n=re(t,p.q(r.slaInterval)/1e3)}var a={serviceids:e,intervals:n};return this.request("service.getsla",a)},e.prototype.getSLA60=function(e,t,r){return Y(this,void 0,void 0,(function(){var n,a,i,o,s,u,l,c,f,d;return J(this,(function(m){switch(m.label){case 0:return n=t[0],a=t[1],i=[{from:n,to:a}],"auto"===r.slaInterval?(o=te(r.intervalMs),i=re(t,o)):"none"!==r.slaInterval&&(o=p.q(r.slaInterval)/1e3,i=re(t,o)),s={output:"extend",serviceids:e},[4,this.request("sla.get",s)];case 1:return 0===(u=m.sent()).length?[2,{}]:(l=u[0],i.map((function(e){return{period_from:e.from,period_to:e.to}})),c={slaid:l.slaid,serviceids:e,period_from:n,period_to:a,periods:Math.min(i.length,100)},[4,this.request("sla.getsli",c)]);case 2:return 0===(f=m.sent()).length?[2,{}]:(d={},f.serviceids.forEach((function(e){d[e]={sla:[]}})),f.sli.forEach((function(e,t){e.forEach((function(e,r){d[f.serviceids[r]].sla.push({downtimeTime:e.downtime,okTime:e.uptime,sla:e.sli,from:f.periods[t].period_from,to:f.periods[t].period_to})}))})),[2,d])}}))}))},e.prototype.getProblems=function(e,t,r,n){var a=n.timeFrom,i=n.timeTo,o=n.recent,s=n.severities,u=n.limit,l=n.acknowledged,c=n.tags,f={output:"extend",selectAcknowledges:"extend",selectSuppressionData:"extend",selectTags:"extend",source:"0",object:"0",sortfield:["eventid"],sortorder:"DESC",evaltype:"0",groupids:e,hostids:t,applicationids:r,recent:o};return s&&(f.severities=s),void 0!==l&&(f.acknowledged=l),c&&(f.tags=c),u&&(f.limit=u),(a||i)&&(f.time_from=a,f.time_till=i),this.request("problem.get",f).then(p.p)},e.prototype.getTriggersByIds=function(e){var t={output:"extend",triggerids:e,expandDescription:!0,expandData:!0,expandComment:!0,monitored:!0,skipDependent:!0,selectGroups:["name"],selectHosts:["name","host","maintenance_status","proxy_hostid"],selectItems:["name","key_","lastvalue"],preservekeys:"1"};return this.request("trigger.get",t).then(p.p)},e.prototype.getTriggers=function(e,t,r,n){var a=n.showTriggers,i=n.maintenance,o=n.timeFrom,s=n.timeTo,u={output:"extend",groupids:e,hostids:t,applicationids:r,expandDescription:!0,expandData:!0,expandComment:!0,monitored:!0,skipDependent:!0,filter:{value:1},selectGroups:["name"],selectHosts:["name","host","maintenance_status","proxy_hostid"],selectItems:["name","key_","lastvalue"],selectLastEvent:"extend",selectTags:"extend"};return a===Z.a.Problems?u.filter.value=1:a!==Z.a.Recent&&a!==Z.a.History||(u.filter.value=[0,1]),i&&(u.maintenance=!0),(o||s)&&(u.lastChangeSince=o,u.lastChangeTill=s),this.request("trigger.get",u)},e.prototype.getEvents=function(e,t,r,n,a){var i={output:"extend",time_from:t,time_till:r,objectids:e,select_acknowledges:"extend",selectHosts:"extend",value:n};return a&&(i.limit=a,i.sortfield="clock",i.sortorder="DESC"),this.request("event.get",i).then(p.p)},e.prototype.getEventsHistory=function(e,t,r,n){var a=n.timeFrom,i=n.timeTo,o=n.severities,s=n.limit,u=n.value,l={output:"extend",time_from:a,time_till:i,value:"1",source:"0",object:"0",evaltype:"0",sortfield:["eventid"],sortorder:"DESC",select_acknowledges:"extend",selectTags:"extend",selectSuppressionData:["maintenanceid","suppress_until"],groupids:e,hostids:t,applicationids:r};return s&&(l.limit=s),o&&(l.severities=o),u&&(l.value=u),this.request("event.get",l).then(p.p)},e.prototype.getExtendedEventData=function(e){var t={output:"extend",eventids:e,preservekeys:!0,select_acknowledges:"extend",selectTags:"extend",sortfield:"clock",sortorder:"DESC"};return this.request("event.get",t)},e.prototype.getEventAlerts=function(e){var t={eventids:e,output:["eventid","message","clock","error"],selectUsers:!0};return this.request("alert.get",t)},e.prototype.getAcknowledges=function(e){var t={output:"extend",eventids:e,preservekeys:!0,select_acknowledges:"extend",sortfield:"clock",sortorder:"DESC"};return this.request("event.get",t).then((function(e){return o.a.filter(e,(function(e){return e.acknowledges.length}))}))},e.prototype.getAlerts=function(e,t,r){var n={output:"extend",itemids:e,expandDescription:!0,expandData:!0,expandComment:!0,monitored:!0,skipDependent:!0,selectLastEvent:"extend"};return(t||r)&&(n.lastChangeSince=t,n.lastChangeTill=r),this.request("trigger.get",n)},e.prototype.getHostAlerts=function(e,t,r){var n=r.minSeverity,a=r.acknowledged,i=r.count,s=r.timeFrom,u=r.timeTo,l={output:"extend",hostids:e,min_severity:n,filter:{value:1},expandDescription:!0,expandData:!0,expandComment:!0,monitored:!0,skipDependent:!0,selectLastEvent:"extend",selectGroups:"extend",selectHosts:["host","name"]};return i&&0!==a&&1!==a&&(l.countOutput=!0),t&&t.length&&(l.applicationids=t),(s||u)&&(l.lastChangeSince=s,l.lastChangeTill=u),this.request("trigger.get",l).then((function(e){return i&&0!==a&&1!==a||(e=function(e,t){return 0===t?o.a.filter(e,(function(e){return"0"===e.lastEvent.acknowledged})):1===t?o.a.filter(e,(function(e){return"1"===e.lastEvent.acknowledged})):e}(e,a),i&&(e=e.length)),e}))},e.prototype.getProxies=function(){return this.request("proxy.get",{output:["proxyid","host"]})},e.prototype.getScripts=function(e,t){var r={output:"extend",hostids:e};return this.request("script.get",r).then(p.p)},e.prototype.executeScript=function(e,t){var r={hostid:e,scriptid:t};return this.request("script.execute",r)},e.prototype.getValueMappings=function(){return this.request("valuemap.get",{output:"extend",selectMappings:"extend"})},e.prototype.getMaintenances=function(e,t){var r={hostids:e,output:["active_since","active_till","name","maintenanceid"],selectGroups:["groupid","name"],selectHosts:["hostid","name"],selectTimeperiods:["start_time","period","timeperiod_type","start_date","every","dayofweek","month","day"]};return t&&(r.groupids=t),this.request("maintenance.get",r)},e}();function te(e){var t=K(100*e)/1e3;return Math.max(t,f.d)}function re(e,t){var r=e[0],n=e[1],a=[];r=Math.floor(r/t)*t,n=Math.ceil(n/t)*t;for(var i=r;i<=n-t;i+=t)a.push({from:i,to:i+t});return a}var ne=function(){function e(e){this.code=e.code||null,this.name=e.message||"",this.data=e.data||"",this.message="Zabbix API Error: "+this.name+" "+this.data}return e.prototype.toString=function(){return this.name+" "+this.data},e}();var ae={historyQuery:function(e,t,r,n,a,i){var o="clock DIV "+a+" * "+a;return"\n      SELECT CAST(itemid AS CHAR) AS metric, "+o+" AS time_sec, "+i+"(value) AS value\n      FROM "+t+"\n      WHERE itemid IN ("+e+")\n        AND clock\n          > "+r+"\n        AND clock\n          < "+n+"\n      GROUP BY "+o+", metric\n      ORDER BY time_sec ASC\n  "},trendsQuery:function(e,t,r,n,a,i,o){var s="clock DIV "+a+" * "+a;return"\n      SELECT CAST(itemid AS CHAR) AS metric, "+s+" AS time_sec, "+i+"("+o+") AS value\n      FROM "+t+"\n      WHERE itemid IN ("+e+")\n        AND clock\n          > "+r+"\n        AND clock\n          < "+n+"\n      GROUP BY "+s+", metric\n      ORDER BY time_sec ASC\n  "},testQuery:function(){return"SELECT CAST(itemid AS CHAR) AS metric, clock AS time_sec, value_avg AS value\n          FROM trends_uint LIMIT 1"}};var ie,oe={historyQuery:function(e,t,r,n,a,i){return"\n      SELECT to_char(itemid, 'FM99999999999999999999') AS metric, "+("clock / "+a+" * "+a)+" AS time, "+i+"(value) AS value\n      FROM "+t+"\n      WHERE itemid IN ("+e+")\n        AND clock\n          > "+r+"\n        AND clock\n          < "+n+"\n      GROUP BY 1, 2\n      ORDER BY time ASC\n  "},trendsQuery:function(e,t,r,n,a,i,o){return"\n      SELECT to_char(itemid, 'FM99999999999999999999') AS metric, "+("clock / "+a+" * "+a)+" AS time, "+i+"("+o+") AS value\n      FROM "+t+"\n      WHERE itemid IN ("+e+")\n        AND clock\n          > "+r+"\n        AND clock\n          < "+n+"\n      GROUP BY 1, 2\n      ORDER BY time ASC\n  "},testQuery:function(){return"\n    SELECT to_char(itemid, 'FM99999999999999999999') AS metric, clock AS time, value_avg AS value\n    FROM trends_uint LIMIT 1\n"}},se=(ie=function(e,t){return(ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}ie(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),ue="postgres",le=function(e){function t(t){var r=e.call(this,t)||this;return r.limit=t.limit||1e4,r.sqlDialect=null,e.prototype.loadDBDataSource.call(r).then((function(){r.loadSQLDialect()})),r}return se(t,e),t.prototype.loadSQLDialect=function(){this.datasourceTypeId===ue?this.sqlDialect=oe:this.sqlDialect=ae},t.prototype.testDataSource=function(){var e=this.sqlDialect.testQuery();return this.invokeSQLQuery(e)},t.prototype.getHistory=function(e,t,r,n){var a=this,i=ce(t,r,n),s=i.aggFunction,u=i.intervalSec,l=o.a.groupBy(e,"value_type"),c=o.a.map(l,(function(e,n){var i=o.a.map(e,"itemid").join(", "),l=H[n],c=a.sqlDialect.historyQuery(i,l,t,r,u,s);return c=Object(p.b)(c),a.invokeSQLQuery(c)}));return Promise.all(c).then((function(e){return o.a.flatten(e)}))},t.prototype.getTrends=function(e,t,r,n){var a=this,i=n.consolidateBy,s=ce(t,r,n),u=s.aggFunction,l=s.intervalSec,c=o.a.groupBy(e,"value_type"),f=o.a.map(c,(function(e,n){var s=o.a.map(e,"itemid").join(", "),c=G[n],f=o.a.includes(["avg","min","max","sum"],i)?i:"avg";f=Q.consolidateByTrendColumns[f];var d=a.sqlDialect.trendsQuery(s,c,t,r,l,u,f);return d=Object(p.b)(d),a.invokeSQLQuery(d)}));return Promise.all(f).then((function(e){return o.a.flatten(e)}))},t.prototype.invokeSQLQuery=function(e){var t={refId:"A",format:"time_series",datasourceId:this.datasourceId,rawSql:e,maxDataPoints:this.limit};return Object(a.getBackendSrv)().datasourceRequest({url:"/api/ds/query",method:"POST",data:{queries:[t]}}).then((function(e){var t=e.data.results;return t.A?t.A.frames:null}))},t}(U);function ce(e,t,r){var n=r.intervalMs,a=r.consolidateBy,i=Math.ceil(n/1e3),o=Math.ceil((t-e)/i);return i=Math.ceil((t-e)/o),{aggFunction:Q.consolidateByFunc[a=a||"avg"],intervalSec:i}}var pe=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fe={avg:"MEAN",min:"MIN",max:"MAX",sum:"SUM",count:"COUNT"},de=function(e){function t(t){var r=e.call(this,t)||this;return r.retentionPolicy=t.retentionPolicy,e.prototype.loadDBDataSource.call(r).then((function(e){return r.influxDS=e,e})),r}return pe(t,e),t.prototype.testDataSource=function(){return this.influxDS.testDatasource().then((function(e){return e.status&&"error"===e.status?Promise.reject({data:{message:"InfluxDB connection error: "+e.message}}):e}))},t.prototype.getHistory=function(e,t,r,n){var a=this,i=n.intervalMs,s=n.retentionPolicy,u=n.consolidateBy,l=Math.ceil(i/1e3),c={timeFrom:t,timeTill:r};u=u||"avg";var p=o.a.groupBy(e,"value_type"),f=o.a.map(p,(function(e,t){var r=o.a.map(e,"itemid"),n=H[t],i=a.buildHistoryQuery(r,n,c,l,u,s);return a.invokeInfluxDBQuery(i)}));return Promise.all(f).then(o.a.flatten).then((function(e){return function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n.error){var a="InfluxDB error: "+n.error;return Promise.reject(new Error(a))}if(n&&n.series)for(var i=e[r].series,o=0;o<i.length;o++){var s=i[o],u=[];if(s.values)for(r=0;r<s.values.length;r++)u[r]=[s.values[r][1],s.values[r][0]];var l={name:s.tags.itemid,points:u};t.push(l)}}return t}(e)}))},t.prototype.getTrends=function(e,t,r,n){return n.retentionPolicy=this.retentionPolicy,this.getHistory(e,t,r,n)},t.prototype.buildHistoryQuery=function(e,t,r,n,a,i){var o=r.timeFrom,s=r.timeTill,u="value";i&&(u=z[a]||"value_avg");var l="SELECT "+(fe[a]||a)+'("'+u+'")\n                   FROM '+(i?'"'+i+'"."'+t+'"':'"'+t+'"')+"\n                   WHERE "+this.buildWhereClause(e)+'\n                     AND "time" >= '+o+'s\n                     AND "time" <= '+s+"s\n                   GROUP BY time("+n+'s), "itemid" fill(none)';return Object(p.b)(l)},t.prototype.buildWhereClause=function(e){return"("+e.map((function(e){return'"itemid" = \''+e+"'"})).join(" OR ")+")"},t.prototype.invokeInfluxDBQuery=function(e){return this.influxDS._seriesQuery(e).then((function(e){return e&&e.results?e.results:[]}))},t}(U);var me=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},he=function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ge=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n},ve=["getHistory","getTrend","getGroups","getHosts","getApps","getItems","getMacros","getItemsByIDs","getEvents","getAlerts","getHostAlerts","getAcknowledges","getITService","getSLA","getVersion","getProxies","getEventAlerts","getExtendedEventData","getProblems","getEventsHistory","getTriggersByIds","getScripts","getGlobalMacros","getValueMappings","getGroupsWithHosts","getHostsByIDs","getMaintenances"],ye=["getGroups","getHosts","getApps","getItems","getMacros","getItemsByIDs","getITService","getProxies","getGlobalMacros","getValueMappings","getGroupsWithHosts","getHostsByIDs","getMaintenances"],be=["getHistory","getTrend","getMacros","getItemsByIDs","getEvents","getAlerts","getHostAlerts","getAcknowledges","getITService","acknowledgeEvent","getProxies","getEventAlerts","getExtendedEventData","getScripts","executeScript","getGlobalMacros","getValueMappings","getHostsByIDs"],Ee=function(){function e(e){var t=this,r=e.basicAuth,n=e.withCredentials,a=e.cacheTTL,i=e.enableDirectDBConnection,o=e.dbConnectionDatasourceId,s=e.dbConnectionDatasourceName,u=e.dbConnectionRetentionPolicy,l=e.datasourceId;this.enableDirectDBConnection=i;var c={enabled:!0,ttl:a};if(this.cachingProxy=new V(c),this.zabbixAPI=new ee(r,n,l),this.proxifyRequests(),this.cacheRequests(),this.bindRequests(),i){var p={dbConnectionRetentionPolicy:u};this.initDBConnector(o,s,p).then((function(){t.getHistoryDB=t.cachingProxy.proxifyWithCache(t.dbConnector.getHistory,"getHistory",t.dbConnector),t.getTrendsDB=t.cachingProxy.proxifyWithCache(t.dbConnector.getTrends,"getTrends",t.dbConnector)}))}}return e.prototype.initDBConnector=function(e,t,r){var n=this;return U.loadDatasource(e,t).then((function(a){var i={datasourceId:e,datasourceName:t};return"influxdb"===a.type?(i.retentionPolicy=r.dbConnectionRetentionPolicy,n.dbConnector=new de(i)):n.dbConnector=new le(i),n.dbConnector}))},e.prototype.proxifyRequests=function(){for(var e=0,t=ve;e<t.length;e++){var r=t[e];this.zabbixAPI[r]=this.cachingProxy.proxify(this.zabbixAPI[r],r,this.zabbixAPI)}},e.prototype.cacheRequests=function(){for(var e=0,t=ye;e<t.length;e++){var r=t[e];this.zabbixAPI[r]=this.cachingProxy.cacheRequest(this.zabbixAPI[r],r,this.zabbixAPI)}},e.prototype.bindRequests=function(){for(var e=0,t=be;e<t.length;e++){var r=t[e];this[r]=this.zabbixAPI[r].bind(this.zabbixAPI)}},e.prototype.testDataSource=function(){var e,t,r=this;return this.getVersion().then((function(t){return e=t,r.getAllGroups()})).then((function(){return r.enableDirectDBConnection?r.dbConnector.testDataSource():Promise.resolve()})).catch((function(e){return Promise.reject(e)})).then((function(n){return n&&(t={dsType:r.dbConnector.datasourceTypeName,dsName:r.dbConnector.datasourceName}),{zabbixVersion:e,dbConnectorStatus:t}}))},e.prototype.getVersion=function(){return me(this,void 0,void 0,(function(){var e;return he(this,(function(t){switch(t.label){case 0:return this.version?[3,3]:this.zabbixAPI.version?(this.version=this.zabbixAPI.version,[3,3]):[3,1];case 1:return e=this,[4,this.zabbixAPI.initVersion()];case 2:e.version=t.sent(),t.label=3;case 3:return[2,this.version]}}))}))},e.prototype.supportsApplications=function(){var e=this.version||this.zabbixAPI.version;return!e||j.a.lt(e,"5.4.0")},e.prototype.supportSLA=function(){var e=this.version||this.zabbixAPI.version;return!e||j.a.gte(e,"6.0.0")},e.prototype.isZabbix54OrHigher=function(){var e=this.version||this.zabbixAPI.version;return!!e&&j.a.gte(e,"5.4.0")},e.prototype.getItemsFromTarget=function(e,t){var r=o.a.map(["group","host","application","itemTag","item"],(function(t){return e[t].filter}));return this.getItems.apply(this,ge(r,[t]))},e.prototype.getHostsFromTarget=function(e){var t=o.a.map(["group","host","application"],(function(t){return e[t].filter}));return Promise.all([this.getHosts.apply(this,t),this.getApps.apply(this,t)]).then((function(e){var t=e[0],r=e[1];return r.appFilterEmpty&&(r=[]),[t,r]}))},e.prototype.getGroupsWithHosts=function(){return this.zabbixAPI.getGroupsWithHosts()},e.prototype.getAllGroups=function(){return this.zabbixAPI.getGroups()},e.prototype.getGroups=function(e){return this.getAllGroups().then((function(t){return xe(t,e)}))},e.prototype.getAllHosts=function(e){var t=this;return this.getGroups(e).then((function(e){var r=o.a.map(e,"groupid");return t.zabbixAPI.getHosts(r)}))},e.prototype.getHosts=function(e,t){return this.getAllHosts(e).then((function(e){return xe(e,t)}))},e.prototype.getMaintenances=function(e,t){return this.zabbixAPI.getMaintenances(e,t)},e.prototype.getAllApps=function(e,t){return me(this,void 0,void 0,(function(){var r=this;return he(this,(function(n){switch(n.label){case 0:return[4,this.getVersion()];case 1:return n.sent(),this.supportsApplications()?[2,this.getHosts(e,t).then((function(e){var t=o.a.map(e,"hostid");return r.zabbixAPI.getApps(t)}))]:[2,[]]}}))}))},e.prototype.getApps=function(e,t,r){return me(this,void 0,Promise,(function(){var n,a=this;return he(this,(function(i){switch(i.label){case 0:return[4,this.getVersion()];case 1:return i.sent(),n=!this.supportsApplications(),[2,this.getHosts(e,t).then((function(e){var t=o.a.map(e,"hostid");if(r&&!n)return a.zabbixAPI.getApps(t).then((function(e){return Ie(e,r)}));var i=t;return i.hostids=t,i.appFilterEmpty=!0,Promise.resolve(i)}))]}}))}))},e.prototype.getItemTags=function(e,t,r){return me(this,void 0,void 0,(function(){var n,a;return he(this,(function(i){switch(i.label){case 0:return[4,this.getAllItems(e,t,null,null,{})];case 1:return n=i.sent(),a=o.a.flatten(n.map((function(e){return e.tags?e.tags:[]}))),a=o.a.uniqBy(a,(function(e){return e.tag+e.value||""})),[2,xe(a.map((function(e){return{name:p.o(e)}})),r)]}}))}))},e.prototype.getAllItems=function(e,t,r,n,a){return void 0===a&&(a={}),me(this,void 0,void 0,(function(){var i,s,u;return he(this,(function(l){switch(l.label){case 0:return[4,this.getApps(e,t,r)];case 1:return i=l.sent(),this.isZabbix54OrHigher()?[4,this.zabbixAPI.getItems(i.hostids,void 0,a.itemtype)]:[3,3];case 2:return s=l.sent(),n&&(s=function(e,t){if(p.m(t)){var r=p.a(t);return e.filter((function(e){return!!e.tags&&e.tags.map((function(e){return p.o(e)})).some((function(e){return r.test(e)}))}))}return e.filter((function(e){return!!e.tags&&e.tags.map((function(e){return p.o(e)})).includes(t)}))}(s,n)),[3,7];case 3:return i.appFilterEmpty?[4,this.zabbixAPI.getItems(i.hostids,void 0,a.itemtype)]:[3,5];case 4:return s=l.sent(),[3,7];case 5:return u=o.a.map(i,"applicationid"),[4,this.zabbixAPI.getItems(void 0,u,a.itemtype)];case 6:s=l.sent(),l.label=7;case 7:return a.showDisabledItems||(s=o.a.filter(s,{status:"0"})),[4,this.expandUserMacro(s,!1)];case 8:return[2,l.sent()]}}))}))},e.prototype.expandUserMacro=function(e,t){var r=this,n=function(e){var t=o.a.map(e,(function(e){return o.a.map(e.hosts,"hostid")}));return o.a.uniq(o.a.flatten(t))}(e);return n&&n.length>0?this.zabbixAPI.getHostsByIDs(n).then((function(a){return a.map((function(e){e.parentTemplates&&e.parentTemplates.map((function(e){-1===n.indexOf(e.templateid)&&n.push(e.templateid)}))})),r.getMacros(n).then((function(n){return o.a.forEach(e,(function(e){p.c(t?e.url:e.name)&&(t?e.url=p.v(e,n,t,a):e.name=p.v(e,n))})),r.getGlobalMacros().then((function(n){return r.getExpandedGlobalMacros(n,e,t)}))}))})):this.getGlobalMacros().then((function(n){return r.getExpandedGlobalMacros(n,e,t)}))},e.prototype.getExpandedGlobalMacros=function(e,t,r){return o.a.forEach(t,(function(t){p.c(r?t.url:t.name)&&(r?t.url=p.v(t,e,r):t.name=p.v(t,e))})),t},e.prototype.getItems=function(e,t,r,n,a,i){return void 0===i&&(i={}),this.getAllItems(e,t,r,n,i).then((function(e){return Ie(e,a)}))},e.prototype.getItemValues=function(e,t,r,n,a){var i=this;return void 0===a&&(a={}),this.getItems(e,t,r,null,n,a).then((function(e){var t=[$()().subtract(2,"h").unix(),$()().unix()];a.range&&(t=[a.range.from.unix(),a.range.to.unix()]);var r=t[0],n=t[1];return i.zabbixAPI.getHistory(e,r,n).then((function(e){return e?o.a.uniq(e.map((function(e){return e.value}))).map((function(e){return{name:e}})):[]}))}))},e.prototype.getITServices=function(e){return this.zabbixAPI.getITService().then((function(t){return xe(t,e)}))},e.prototype.getProblems=function(e,t,r,n,a){var i=this,s=[this.getGroups(e),this.getHosts(e,t),this.getApps(e,t,r)];return Promise.all(s).then((function(n){var a=n[0],i=n[1],s=n[2],u={};return r&&(u.applicationids=o.a.flatten(o.a.map(s,"applicationid"))),t&&"/.*/"!==t&&(u.hostids=o.a.map(i,"hostid")),e&&(u.groupids=o.a.map(a,"groupid")),u})).then((function(e){return i.zabbixAPI.getProblems(e.groupids,e.hostids,e.applicationids,a)})).then((function(e){var t=null==e?void 0:e.map((function(e){return e.objectid}));return Promise.all([Promise.resolve(e),i.zabbixAPI.getTriggersByIds(t)])})).then((function(e){return L(e[0],e[1])})).then((function(e){return i.filterTriggersByProxy(e,n)})).then((function(e){return i.expandUserMacro.bind(i)(e,!0)}))},e.prototype.getProblemsHistory=function(e,t,r,n,a){var i=this,s=a.valueFromEvent,u=[this.getGroups(e),this.getHosts(e,t),this.getApps(e,t,r)];return Promise.all(u).then((function(n){var a=n[0],i=n[1],s=n[2],u={};return r&&(u.applicationids=o.a.flatten(o.a.map(s,"applicationid"))),t&&(u.hostids=o.a.map(i,"hostid")),e&&(u.groupids=o.a.map(a,"groupid")),u})).then((function(e){return i.zabbixAPI.getEventsHistory(e.groupids,e.hostids,e.applicationids,a)})).then((function(e){var t=null==e?void 0:e.map((function(e){return e.objectid}));return Promise.all([Promise.resolve(e),i.zabbixAPI.getTriggersByIds(t)])})).then((function(e){return F(e[0],e[1],{valueFromEvent:s})})).then((function(e){return i.filterTriggersByProxy(e,n)})).then((function(e){return i.expandUserMacro.bind(i)(e,!0)}))},e.prototype.filterTriggersByProxy=function(e,t){return this.getFilteredProxies(t).then((function(r){if(t&&"/.*/"!==t&&e){var n=r.map((function(e){return e.proxyid}));e=e.filter((function(e){for(var t=0;t<e.hosts.length;t++){var r=e.hosts[t];if(n.includes(r.proxy_hostid))return!0}return!1}))}return e}))},e.prototype.getFilteredProxies=function(e){return this.zabbixAPI.getProxies().then((function(t){return t.forEach((function(e){return e.name=e.host})),xe(t,e)}))},e.prototype.getHistoryTS=function(e,t,r){var n=t[0],a=t[1];return this.enableDirectDBConnection?this.getHistoryDB(e,n,a,r).then((function(t){return N.dataResponseToTimeSeries(t,e,r)})):this.zabbixAPI.getHistory(e,n,a).then((function(t){return N.handleHistory(t,e)}))},e.prototype.getTrends=function(e,t,r){var n=t[0],a=t[1];if(this.enableDirectDBConnection)return this.getTrendsDB(e,n,a,r).then((function(t){return N.dataResponseToTimeSeries(t,e,r)}));var i=r.consolidateBy||r.valueType;return this.zabbixAPI.getTrend(e,n,a).then((function(t){return N.handleTrends(t,e,i)})).then(N.sortTimeseries)},e.prototype.getHistoryText=function(e,t,r){var n=t[0],a=t[1];return e.length?this.zabbixAPI.getHistory(e,n,a).then((function(t){return"table"===r.resultFormat?N.handleHistoryAsTable(t,e,r):N.handleText(t,e,r)})):Promise.resolve([])},e.prototype.getSLA=function(e,t,r,n){return me(this,void 0,void 0,(function(){var a,i,s;return he(this,(function(u){switch(u.label){case 0:return a=o.a.map(e,"serviceid"),this.supportSLA()?[4,this.zabbixAPI.getSLA60(a,t,n)]:[3,2];case 1:return i=u.sent(),[2,o.a.map(a,(function(t){var n=o.a.find(e,{serviceid:t});return N.handleSLAResponse(n,r.slaProperty,i)}))];case 2:return[4,this.zabbixAPI.getSLA(a,t,n)];case 3:return s=u.sent(),[2,o.a.map(a,(function(t){var n=o.a.find(e,{serviceid:t});return N.handleSLAResponse(n,r.slaProperty,s)}))]}}))}))},e}();function Te(e,t){var r=p.a(t);return o.a.filter(e,(function(e){return r.test(e.name)}))}function xe(e,t){return p.m(t)?Te(e,t):function(e,t){var r=o.a.find(e,{name:t});return r?[r]:[]}(e,t)}function Ie(e,t){return p.m(t)?Te(e,t):function(e,t){var r=o.a.filter(e,{name:t});return r||[]}(e,t)}var we=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ae=function(){return(Ae=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Se=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},Pe=function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},De=function(e){function t(t,r){var n=e.call(this,t)||this;n.templateSrv=r,n.isBackendTarget=function(e){return!n.enableDirectDBConnection&&(e.queryType===f.g||e.queryType===f.e)},n.isDBConnectionTarget=function(e){return n.enableDirectDBConnection&&(e.queryType===f.g||e.queryType===f.e)},n.templateSrv=r,n.enableDebugLog="development"===u.a.buildInfo.env,n.replaceTemplateVars=o.a.partial(Ne,n.templateSrv),n.datasourceId=t.id,n.name=t.name,n.basicAuth=t.basicAuth,n.withCredentials=t.withCredentials;var a=h(t.jsonData);n.trends=a.trends,n.trendsFrom=a.trendsFrom||"7d",n.trendsRange=a.trendsRange||"4d";var i=a.cacheTTL||"1h";n.cacheTTL=p.q(i),n.disableReadOnlyUsersAck=a.disableReadOnlyUsersAck,n.disableDataAlignment=a.disableDataAlignment,n.enableDirectDBConnection=a.dbConnectionEnable||!1,n.dbConnectionDatasourceId=a.dbConnectionDatasourceId,n.dbConnectionDatasourceName=a.dbConnectionDatasourceName,n.dbConnectionRetentionPolicy=a.dbConnectionRetentionPolicy;var s={basicAuth:n.basicAuth,withCredentials:n.withCredentials,cacheTTL:n.cacheTTL,enableDirectDBConnection:n.enableDirectDBConnection,dbConnectionDatasourceId:n.dbConnectionDatasourceId,dbConnectionDatasourceName:n.dbConnectionDatasourceName,dbConnectionRetentionPolicy:n.dbConnectionRetentionPolicy,datasourceId:n.datasourceId};return n.zabbix=new Ee(s),n}return t.$inject=["instanceSettings","templateSrv"],we(t,e),t.prototype.query=function(e){var t=e.targets.map((function(e){return d(o.a.cloneDeep(e))})),r=this.backendQuery(Ae(Ae({},e),{targets:t})),a=this.dbConnectionQuery(Ae(Ae({},e),{targets:t})),i=this.frontendQuery(Ae(Ae({},e),{targets:t}));return Promise.all([r,a,i]).then((function(t){var r=t[0],a=t[1],i=t[2];return a.data&&(r.data=r.data.concat(a.data)),i.data&&(r.data=r.data.concat(i.data)),{data:r.data,state:n.LoadingState.Done,key:e.requestId}}))},t.prototype.backendQuery=function(e){return Se(this,void 0,Promise,(function(){var t,r,n,i,s,u,l,c,f,d,m=this;return Pe(this,(function(h){switch(h.label){case 0:if(t=e.intervalMs,r=e.maxDataPoints,n=e.range,i=e.requestId,s=e.targets.filter(this.isBackendTarget),e.scopedVars=Object.assign({},e.scopedVars,p.i(e.range)),!(u=o.a.compact(s.map((function(n){return n.hide?null:(m.replaceTargetVariables(n,e),Ae(Ae({},n),{datasourceId:m.datasourceId,intervalMs:t,maxDataPoints:r}))})))).length)return[2,Promise.resolve({data:[]})];l={queries:u},n&&(l.range=n,l.from=n.from.valueOf().toString(),l.to=n.to.valueOf().toString()),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Object(a.getBackendSrv)().fetch({url:"/api/ds/query",method:"POST",data:l,requestId:i}).toPromise()];case 2:return c=h.sent(),[3,4];case 3:return f=h.sent(),[2,Object(a.toDataQueryResponse)(f)];case 4:return d=Object(a.toDataQueryResponse)(c),this.sortByRefId(d),this.applyFrontendFunctions(d,e),N.convertZabbixUnits(d),N.isConvertibleToWide(d.data)&&(console.log("Converting response to the wide format"),d.data=N.convertToWide(d.data)),[2,d]}}))}))},t.prototype.frontendQuery=function(e){return Se(this,void 0,Promise,(function(){var t,r,a=this;return Pe(this,(function(i){return t=e.targets.filter((function(e){return!(a.isBackendTarget(e)||a.isDBConnectionTarget(e))})),r=o.a.map(t,(function(t){if(t.hide)return[];e.scopedVars=Object.assign({},e.scopedVars,p.i(e.range)),a.replaceTargetVariables(t,e);var r=a.buildTimeRange(e,t);return t.queryType&&t.queryType!==f.g&&t.queryType!==f.i?t.queryType===f.f?a.queryITServiceData(t,r,e):t.queryType===f.j?a.queryTriggersData(t,r):t.queryType===f.h?a.queryProblems(t,r,e):[]:t.group&&t.host&&t.item&&(!(t.queryType>-1)||(t.group||{}).filter||(t.host||{}).filter||(t.item||{}).filter)?a.queryTextData(t,r):[]})),[2,Promise.all(o.a.flatten(r)).then(o.a.flatten).then((function(e){return e&&e.length>0&&Object(n.isDataFrame)(e[0])&&!p.l(e[0])&&(e=N.alignFrames(e),N.isConvertibleToWide(e)&&(console.log("Converting response to the wide format"),e=N.convertToWide(e))),{data:e}}))]}))}))},t.prototype.dbConnectionQuery=function(e){return Se(this,void 0,Promise,(function(){var t,r,n=this;return Pe(this,(function(a){return t=e.targets.filter(this.isDBConnectionTarget),r=o.a.compact(t.map((function(t){if(t.hide)return[];e.scopedVars=Object.assign({},e.scopedVars,p.i(e.range)),n.replaceTargetVariables(t,e);var r=n.buildTimeRange(e,t),a=n.isUseTrends(r);return t.queryType&&t.queryType!==f.g?t.queryType===f.e&&t.itemids?n.queryItemIdData(t,r,a,e):[]:n.queryNumericData(t,r,a,e)}))),[2,Promise.all(r).then(o.a.flatten).then((function(e){return{data:e}}))]}))}))},t.prototype.buildTimeRange=function(e,t){var r=Math.ceil(c.parse(e.range.from)/1e3),n=Math.ceil(c.parse(e.range.to)/1e3),a=Oe(t.functions,"Time");if(a.length){var i=p.w(a)([r,n]);r=i[0],n=i[1]}return[r,n]},t.prototype.queryNumericData=function(e,t,r,n){return Se(this,void 0,Promise,(function(){var a,i,o,s,u;return Pe(this,(function(l){switch(l.label){case 0:return a={itemtype:"num"},[4,this.zabbix.getItemsFromTarget(e,a)];case 1:return i=l.sent(),o=(new Date).getTime(),[4,this.queryNumericDataForItems(i,e,t,r,n)];case 2:return s=l.sent(),u=(new Date).getTime(),this.enableDebugLog&&console.log("Datasource::Performance Query Time ("+this.name+"): "+(u-o)),[2,this.handleBackendPostProcessingResponse(s,n,e)]}}))}))},t.prototype.queryNumericDataForItems=function(e,t,r,n,a){return Se(this,void 0,void 0,(function(){var i,s;return Pe(this,(function(u){switch(u.label){case 0:return a.valueType=this.getTrendValueType(t),a.consolidateBy=function(e){var t,r=o.a.find(e.functions,(function(e){return"consolidateBy"===e.def.name}));r&&r.params&&r.params.length&&(t=r.params[0]);return t}(t)||a.valueType,n?[4,this.zabbix.getTrends(e,r,a)]:[3,2];case 1:return i=u.sent(),[3,4];case 2:return[4,this.zabbix.getHistoryTS(e,r,a)];case 3:i=u.sent(),u.label=4;case 4:return s={from:r[0],to:r[1]},[4,this.invokeDataProcessingQuery(i,t,s)];case 5:return[2,u.sent()]}}))}))},t.prototype.invokeDataProcessingQuery=function(e,t,r){return Se(this,void 0,void 0,(function(){var n;return Pe(this,(function(i){switch(i.label){case 0:return n={url:"/api/datasources/"+this.datasourceId+"/resources/db-connection-post",method:"POST",headers:{"Content-Type":"application/json"},hideFromInspector:!1,data:{series:e,query:t,timeRange:r}},[4,Object(a.getBackendSrv)().fetch(n).toPromise()];case 1:return[2,i.sent().data]}}))}))},t.prototype.handleBackendPostProcessingResponse=function(e,t,r){for(var a=[],i=0,o=e;i<o.length;i++){var s=o[i],u=Object(n.dataFrameFromJSON)(s);u.refId=r.refId,a.push(u)}var l={data:a};return this.sortByRefId(l),this.applyFrontendFunctions(l,t),N.isConvertibleToWide(l.data)&&(console.log("Converting response to the wide format"),l.data=N.convertToWide(l.data)),l.data},t.prototype.getTrendValueType=function(e){var t=o.a.map(T().Trends,"name"),r=o.a.find(e.functions,(function(e){return o.a.includes(t,e.def.name)}));return r?r.params[0]:"avg"},t.prototype.sortByRefId=function(e){e.data.sort((function(e,t){return e.refId<t.refId?-1:e.refId>t.refId?1:0}))},t.prototype.applyFrontendFunctions=function(e,t){for(var r=0;r<e.data.length;r++){var n=e.data[r],a=Oe(Le(t,n.refId).functions,"Alias");p.w(a)(n)}return e},t.prototype.queryTextData=function(e,t){var r=this;return this.zabbix.getItemsFromTarget(e,{itemtype:"text"}).then((function(n){return r.zabbix.getHistoryText(n,t,e)})).then((function(t){return"table"!==e.resultFormat?t.map((function(t){return N.seriesToDataFrame(t,e,[],n.FieldType.string)})):t}))},t.prototype.queryItemIdData=function(e,t,r,n){var a=this,i=e.itemids;return i=this.templateSrv.replace(i,n.scopedVars,Ce),(i=o.a.map(i.split(","),(function(e){return e.trim()})))?this.zabbix.getItemsByIDs(i).then((function(i){return a.queryNumericDataForItems(i,e,t,r,n)})):[]},t.prototype.queryITServiceData=function(e,t,r){var n;return Se(this,void 0,void 0,(function(){var a,i,s,u,l;return Pe(this,(function(c){switch(c.label){case 0:return e.hide||!e.itservice&&!e.itServiceFilter||!e.slaProperty?[2,[]]:(r.isOldVersion=e.itservice&&!e.itServiceFilter,a=r.isOldVersion?"/.*/":this.replaceTemplateVars(e.itServiceFilter,r.scopedVars),r.slaInterval=e.slaInterval,[4,this.zabbix.getITServices(a)]);case 1:return i=c.sent(),r.isOldVersion&&(i=o.a.filter(i,{serviceid:null===(n=e.itservice)||void 0===n?void 0:n.serviceid})),[4,this.zabbix.getSLA(i,t,e,r)];case 2:return s=c.sent(),u=N.itServiceResponseToTimeSeries(s,e.slaInterval),[4,this.invokeDataProcessingQuery(u,e,{})];case 3:return l=c.sent(),[2,this.handleBackendPostProcessingResponse(l,r,e)]}}))}))},t.prototype.queryTriggersData=function(e,t){var r=this,n=t[0],a=t[1];return this.zabbix.getHostsFromTarget(e).then((function(i){var s=i[0],u=i[1];if(s.length){var l=o.a.map(s,"hostid"),c=o.a.map(u,"applicationid"),p={minSeverity:e.triggers.minSeverity,acknowledged:e.triggers.acknowledged,count:e.triggers.count,timeFrom:n,timeTo:a},f=e.group.filter;return Promise.all([r.zabbix.getHostAlerts(l,c,p),r.zabbix.getGroups(f)]).then((function(e){var r=e[0],n=e[1];return N.handleTriggersResponse(r,n,t)}))}return Promise.resolve([])}))},t.prototype.queryProblems=function(e,t,r){var n,a,i,s,u,c,f,d,m,h,g,v,y,b,E,T,x=t[0],I=t[1],w=l.contextSrv.isEditor||l.contextSrv.isGrafanaAdmin,A=e.showProblems||Z.a.Problems,S=e.options.hostProxy?this.zabbix.getProxies():function(){return[]};T=!this.disableReadOnlyUsersAck||w;var P=this.replaceTemplateVars(null===(n=e.group)||void 0===n?void 0:n.filter,r.scopedVars),D=this.replaceTemplateVars(null===(a=e.host)||void 0===a?void 0:a.filter,r.scopedVars),O=this.replaceTemplateVars(null===(i=e.application)||void 0===i?void 0:i.filter,r.scopedVars),R=this.replaceTemplateVars(null===(s=e.proxy)||void 0===s?void 0:s.filter,r.scopedVars),_=this.replaceTemplateVars(null===(u=e.trigger)||void 0===u?void 0:u.filter,r.scopedVars),C=this.replaceTemplateVars(null===(c=e.tags)||void 0===c?void 0:c.filter,r.scopedVars),N=Ae(Ae({},e),{trigger:{filter:_},tags:{filter:C}}),L=C.replace("/^","").replace("$/",""),F=p.t(L);F.forEach((function(e){e.operator=1}));var k,$={recent:A===Z.a.Recent,minSeverity:null===(f=e.options)||void 0===f?void 0:f.minSeverity,limit:null===(d=e.options)||void 0===d?void 0:d.limit};if(F&&F.length&&($.tags=F),0!==(null===(m=e.options)||void 0===m?void 0:m.acknowledged)&&1!==(null===(h=e.options)||void 0===h?void 0:h.acknowledged)||($.acknowledged=!!(null===(g=e.options)||void 0===g?void 0:g.acknowledged)),null===(v=e.options)||void 0===v?void 0:v.minSeverity){var q=[0,1,2,3,4,5].filter((function(t){var r;return t>=(null===(r=e.options)||void 0===r?void 0:r.minSeverity)}));(null===(y=e.options)||void 0===y?void 0:y.severities)&&(q=q.filter((function(t){var r;return null===(r=e.options)||void 0===r?void 0:r.severities.includes(t)}))),$.severities=q}return A===Z.a.History||(null===(b=e.options)||void 0===b?void 0:b.useTimeRange)?($.timeFrom=x,$.timeTo=I,k=this.zabbix.getProblemsHistory(P,D,O,R,$)):k=this.zabbix.getProblems(P,D,O,R,$),Promise.all([k,S]).then((function(e){var t=e[0],r=e[1];return E=o.a.keyBy(r,"proxyid"),t})).then((function(e){return M.setMaintenanceStatus(e)})).then((function(e){return M.setAckButtonStatus(e,T)})).then((function(e){return M.filterTriggersPre(e,N)})).then((function(t){return M.sortProblems(t,e)})).then((function(t){return M.addTriggerDataSource(t,e)})).then((function(e){return M.addTriggerHostProxy(e,E)})).then((function(e){return M.toDataFrame(e)}))},t.prototype.testDatasource=function(){return Se(this,void 0,void 0,(function(){var e,t,r,n,a;return Pe(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.zabbix.testDataSource()];case 1:return e=i.sent(),t=e.zabbixVersion,r=e.dbConnectorStatus,n="Zabbix API version: "+t,r&&(n+=", DB connector type: "+r.dsType),[2,{status:"success",title:"Success",message:n}];case 2:return(a=i.sent())instanceof ne?[2,{status:"error",title:a.message,message:a.message}]:a.data&&a.data.message?[2,{status:"error",title:"Zabbix Client Error",message:a.data.message}]:"string"==typeof a?[2,{status:"error",title:"Unknown Error",message:a}]:(console.log(a),[2,{status:"error",title:"Connection failed",message:"Could not connect to given url"}]);case 3:return[2]}}))}))},t.prototype.metricFindQuery=function(e,t){var r,n=o.a.cloneDeep(e);if(!e)return Promise.resolve([]);"string"==typeof e&&(n=p.s(e));for(var a=0,i=["group","host","application","itemTag","item"];a<i.length;a++){var s=i[a];n[s]=this.replaceTemplateVars(n[s],{})}var u=n.group,l=n.host,c=n.application,f=n.item;switch(n.queryType){case Z.b.Group:r=this.zabbix.getGroups(n.group);break;case Z.b.Host:r=this.zabbix.getHosts(n.group,n.host);break;case Z.b.Application:r=this.zabbix.getApps(n.group,n.host,n.application);break;case Z.b.ItemTag:r=this.zabbix.getItemTags(n.group,n.host,n.itemTag);break;case Z.b.Item:r=this.zabbix.getItems(n.group,n.host,n.application,null,n.item);break;case Z.b.ItemValues:var d=null==t?void 0:t.range;r=this.zabbix.getItemValues(u,l,c,f,{range:d});break;default:r=Promise.resolve([])}return r.then((function(e){return o.a.map(e,Re)}))},t.prototype.targetContainsTemplate=function(e){var t,r,n,i,o,s,u,l=Object(a.getTemplateSrv)();return l.variableExists(null===(t=e.group)||void 0===t?void 0:t.filter)||l.variableExists(null===(r=e.host)||void 0===r?void 0:r.filter)||l.variableExists(null===(n=e.application)||void 0===n?void 0:n.filter)||l.variableExists(null===(i=e.itemTag)||void 0===i?void 0:i.filter)||l.variableExists(null===(o=e.item)||void 0===o?void 0:o.filter)||l.variableExists(null===(s=e.proxy)||void 0===s?void 0:s.filter)||l.variableExists(null===(u=e.trigger)||void 0===u?void 0:u.filter)||l.variableExists(e.textFilter)||l.variableExists(e.itServiceFilter)},t.prototype.annotationQuery=function(e){var t=this,r=e.range||e.rangeRaw,n=Math.ceil(c.parse(r.from)/1e3),a=Math.ceil(c.parse(r.to)/1e3),i=e.annotation,s={value:i.showOkEvents?["0","1"]:"1",valueFromEvent:!0,timeFrom:n,timeTo:a};if(i.minseverity){var u=[0,1,2,3,4,5].filter((function(e){return e>=Number(i.minseverity)}));s.severities=u}var l=this.replaceTemplateVars(i.group,{}),f=this.replaceTemplateVars(i.host,{}),d=this.replaceTemplateVars(i.application,{});return this.zabbix.getProblemsHistory(l,f,d,void 0,s).then((function(e){var r=t.replaceTemplateVars(i.trigger,{});return p.m(r)?e=o.a.filter(e,(function(e){return p.a(r).test(e.description)})):r&&(e=o.a.filter(e,(function(e){return e.description===r}))),i.hideAcknowledged&&(e=o.a.filter(e,(function(e){var t;return!(null===(t=e.acknowledges)||void 0===t?void 0:t.length)}))),o.a.map(e,(function(e){var t=p.h(e.acknowledges),r=[];return i.showHostname&&(r=o.a.map(e.hosts,"name")),{title:"1"===e.value?"Problem":"OK",time:1e3*e.timestamp,annotation:i,text:e.name+t,tags:r}}))}))},t.prototype.replaceTargetVariables=function(e,t){var r=this;o.a.forEach(["group","host","application","itemTag","item"],(function(n){if(e[n]&&e[n].filter&&r.checkForTemplateVariables(e[n].filter,r.templateSrv.getVariables())){var a=e[n].filter;e[n].filter=r.replaceTemplateVars(e[n].filter,t.scopedVars),a!==e[n].filter&&"/^$/"===e[n].filter&&(e[n].filter="/.*/")}})),e.textFilter&&(e.textFilter=this.replaceTemplateVars(e.textFilter,t.scopedVars)),e.itemids&&(e.itemids=this.templateSrv.replace(e.itemids,t.scopedVars,Ce)),o.a.forEach(e.functions,(function(e){e.params=o.a.map(e.params,(function(e){return"number"==typeof e?+r.templateSrv.replace(e.toString(),t.scopedVars):r.templateSrv.replace(e,t.scopedVars)}))}))},t.prototype.checkForTemplateVariables=function(e,t){return t.some((function(t){return e.indexOf("$"+t.name)>-1||e.indexOf("${"+t.name+"}")>-1}))},t.prototype.isUseTrends=function(e){var t=e[0],r=e[1],n=Math.ceil(c.parse("now-"+this.trendsFrom)/1e3),a=Math.ceil(p.q(this.trendsRange)/1e3);return this.trends&&(t<n||r-t>a)},t}(n.DataSourceApi);function Oe(e,t){var r=o.a.map(T()[t],"name"),n=o.a.filter(e,(function(e){return o.a.includes(r,e.def.name)}));return o.a.map(n,(function(e){return E(e.def,e.params).bindFunction(w.metricFunctions)}))}function Re(e){return{text:e.name,expandable:!1}}function _e(e){return"string"==typeof e?p.e(e):"("+o.a.map(e,p.e).join("|")+")"}function Ce(e){return"string"==typeof e?e:e.join(",")}function Ne(e,t,r){var n=e.replace(t,r,_e);return t&&t!==n&&!p.m(n)&&(n="/^"+n+"$/"),n}function Le(e,t){for(var r=0;r<e.targets.length;r++){var n=e.targets[r];if(n.refId===t)return n}return null}var Fe=r(18),Me=r(19),ke=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$e=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},qe=function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};var je,Ve,Be,He,Ge=function(e){function t(t,r,n){var i=e.call(this,t,r)||this;return i.getItemTags=function(){var e;if(!(null===(e=i.metric)||void 0===e?void 0:e.tagList))return[];var t=i.metric.tagList.map((function(e){return Object(p.o)(e)}));return o.a.forEach(i.templateSrv.getVariables(),(function(e){t.unshift("$"+e.name)})),t},i.zabbix=i.datasource.zabbix,i.replaceTemplateVars=i.datasource.replaceTemplateVars,i.templateSrv=Object(a.getTemplateSrv)(),i.editorModes=[{value:"num",text:"Metrics",queryType:f.g},{value:"text",text:"Text",queryType:f.i},{value:"itservice",text:"IT Services",queryType:f.f},{value:"itemid",text:"Item ID",queryType:f.e},{value:"triggers",text:"Triggers",queryType:f.j},{value:"problems",text:"Problems",queryType:f.h}],i.$scope.editorMode={METRICS:f.g,TEXT:f.i,ITSERVICE:f.f,ITEMID:f.e,TRIGGERS:f.j,PROBLEMS:f.h},i.slaPropertyList=[{name:"Status",property:"status"},{name:"SLA",property:"sla"},{name:"OK time",property:"okTime"},{name:"Problem time",property:"problemTime"},{name:"Down time",property:"downtimeTime"}],i.slaIntervals=[{text:"No interval",value:"none"},{text:"Auto",value:"auto"},{text:"1 hour",value:"1h"},{text:"12 hours",value:"12h"},{text:"24 hours",value:"1d"},{text:"1 week",value:"1w"},{text:"1 month",value:"1M"}],i.ackFilters=[{text:"all triggers",value:2},{text:"unacknowledged",value:0},{text:"acknowledged",value:1}],i.problemAckFilters=["all triggers","unacknowledged","acknowledged"],i.sortByFields=[{text:"Default",value:"default"},{text:"Last change",value:"lastchange"},{text:"Severity",value:"severity"}],i.showEventsFields=[{text:"All",value:[0,1]},{text:"OK",value:[0]},{text:"Problems",value:1}],i.showProblemsOptions=[{text:"Problems",value:"problems"},{text:"Recent problems",value:"recent"},{text:"History",value:"history"}],i.resultFormats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],i.severityOptions=f.l,i.getGroupNames=o.a.bind(i.getMetricNames,i,"groupList"),i.getHostNames=o.a.bind(i.getMetricNames,i,"hostList",!0),i.getApplicationNames=o.a.bind(i.getMetricNames,i,"appList"),i.getItemNames=o.a.bind(i.getMetricNames,i,"itemList"),i.getITServices=o.a.bind(i.getMetricNames,i,"itServiceList"),i.getProxyNames=o.a.bind(i.getMetricNames,i,"proxyList"),i.getVariables=o.a.bind(i.getTemplateVariables,i),n.$on("template-variable-value-updated",(function(){return i.onVariableChange()})),t.$on("typeahead-updated",(function(){i.onTargetBlur()})),i.init=function(){var e=i.target;e=d(e),i.refresh();var t={metric:{},oldTarget:o.a.cloneDeep(i.target),queryOptionsText:i.renderQueryOptionsText()};o.a.defaults(i,t);var r={queryType:f.g,group:{filter:""},host:{filter:""},application:{filter:""},itemTag:{filter:""},item:{filter:""},functions:[],triggers:{count:!0,minSeverity:3,acknowledged:2},trigger:{filter:""},tags:{filter:""},proxy:{filter:""},options:{showDisabledItems:!1,skipEmptyValues:!1,disableDataAlignment:!1,useZabbixValueMapping:!1},table:{skipEmptyValues:!1}};o.a.defaultsDeep(e,r),i.initDefaultQueryMode(e),i.panel.type===f.m&&(e.queryType=f.h,e.options.severities=function(e){if(!e)return[0,1,2,3,4,5];for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r];a.show&&t.push(a.priority)}return t}(i.panel.triggerSeverity)),e.functions=o.a.map(e.functions,(function(e){return E(e.def,e.params)})),e.queryType===f.f&&o.a.defaultsDeep(e,{slaProperty:{name:"SLA",property:"sla"},slaInterval:"none"}),e.queryType===f.h&&o.a.defaultsDeep(e,{showProblems:Z.a.Problems,options:{minSeverity:0,sortProblems:"default",acknowledged:2,hostsInMaintenance:!1,hostProxy:!1,limit:f.c}}),e.queryType===f.g||e.queryType===f.i||e.queryType===f.j||e.queryType===f.h?i.initFilters():e.queryType===f.f&&i.suggestITServices()},i.panel.type===f.m&&(i.panel.schemaVersion=Me.a),i.init(),i.queryOptionsText=i.renderQueryOptionsText(),i}return t.$inject=["$scope","$injector","$rootScope"],ke(t,e),t.prototype.initFilters=function(){var e=this,t=o.a.find(this.editorModes,{queryType:this.target.queryType}),r=t?t.value:null,n=[this.suggestGroups(),this.suggestHosts(),this.suggestApps()];return this.target.queryType!==f.g&&this.target.queryType!==f.i||n.push(this.suggestItems(r)),this.target.queryType===f.h&&n.push(this.suggestProxies()),Promise.all(n).then((function(){e.zabbix.isZabbix54OrHigher()&&e.suggestItemTags().then((function(){return e.$scope.$apply()}))}))},t.prototype.initDefaultQueryMode=function(e){e.queryType!==f.g&&e.queryType!==f.i&&e.queryType!==f.f&&e.queryType!==f.e&&e.queryType!==f.j&&e.queryType!==f.h&&(e.queryType=f.g)},t.prototype.getMetricNames=function(e,t){var r=o.a.uniq(o.a.map(this.metric[e],"name"));return o.a.forEach(this.templateSrv.getVariables(),(function(e){r.unshift("$"+e.name)})),t&&r.unshift("/.*/"),r},t.prototype.getTemplateVariables=function(){return o.a.map(this.templateSrv.getVariables(),(function(e){return"$"+e.name}))},t.prototype.isZabbix54OrHigher=function(){return this.zabbix.isZabbix54OrHigher()},t.prototype.suggestGroups=function(){var e=this;return this.zabbix.getAllGroups().then((function(t){return e.metric.groupList=t,t}))},t.prototype.suggestHosts=function(){var e=this,t=this.replaceTemplateVars(this.target.group.filter);return this.zabbix.getAllHosts(t).then((function(t){return e.metric.hostList=t,t}))},t.prototype.suggestApps=function(){var e=this,t=this.replaceTemplateVars(this.target.group.filter),r=this.replaceTemplateVars(this.target.host.filter);return this.zabbix.getAllApps(t,r).then((function(t){return e.metric.appList=t,t}))},t.prototype.suggestItems=function(e){var t=this;void 0===e&&(e="num");var r=this.replaceTemplateVars(this.target.group.filter),n=this.replaceTemplateVars(this.target.host.filter),a=this.replaceTemplateVars(this.target.application.filter),i=this.replaceTemplateVars(this.target.itemTag.filter),o={itemtype:e,showDisabledItems:this.target.options.showDisabledItems};return this.zabbix.getAllItems(r,n,a,i,o).then((function(e){return t.metric.itemList=e,e}))},t.prototype.suggestItemTags=function(){return $e(this,void 0,void 0,(function(){var e,t,r,n;return qe(this,(function(a){switch(a.label){case 0:return e=this.replaceTemplateVars(this.target.group.filter),t=this.replaceTemplateVars(this.target.host.filter),[4,this.zabbix.getAllItems(e,t,null,null,{})];case 1:return r=a.sent(),n=o.a.flatten(r.map((function(e){return e.tags?e.tags:[]}))),this.metric.tagList=o.a.uniqBy(n,(function(e){return e.tag+e.value||""})),[2]}}))}))},t.prototype.suggestITServices=function(){var e=this;return this.zabbix.getITService().then((function(t){return e.metric.itServiceList=t,t}))},t.prototype.suggestProxies=function(){var e=this;return this.zabbix.getProxies().then((function(t){var r=o.a.map(t,"host");return e.metric.proxyList=r,r}))},t.prototype.isRegex=function(e){return p.m(e)},t.prototype.isVariable=function(e){return p.n(e,this.templateSrv.getVariables())},t.prototype.onTargetBlur=function(){var e=o.a.cloneDeep(this.target);o.a.isEqual(this.oldTarget,this.target)||(this.oldTarget=e,this.targetChanged())},t.prototype.onVariableChange=function(){this.isContainsVariables()&&this.targetChanged()},t.prototype.isContainsVariables=function(){var e=this;return o.a.some(["group","host","application"],(function(t){return!(!e.target[t]||!e.target[t].filter)&&p.n(e.target[t].filter,e.templateSrv.getVariables())}))},t.prototype.parseTarget=function(){},t.prototype.validateTarget=function(){},t.prototype.targetChanged=function(){this.initFilters(),this.parseTarget(),this.refresh()},t.prototype.addFunction=function(e){var t=E(e);t.added=!0,this.target.functions.push(t),this.moveAliasFuncLast(),(t.params.length&&t.added||0===t.def.params.length)&&this.targetChanged()},t.prototype.removeFunction=function(e){this.target.functions=o.a.without(this.target.functions,e),this.targetChanged()},t.prototype.moveFunction=function(e,t){var r=this.target.functions.indexOf(e);o.a.move(this.target.functions,r,r+t),this.targetChanged()},t.prototype.moveAliasFuncLast=function(){var e=o.a.find(this.target.functions,(function(e){return"Alias"===e.def.category}));e&&(this.target.functions=o.a.without(this.target.functions,e),this.target.functions.push(e))},t.prototype.toggleQueryOptions=function(){this.showQueryOptions=!this.showQueryOptions},t.prototype.onQueryOptionChange=function(){this.queryOptionsText=this.renderQueryOptionsText(),this.onTargetBlur()},t.prototype.renderQueryOptionsText=function(){var e={};this.target.queryType===f.g?e={showDisabledItems:"Show disabled items",disableDataAlignment:"Disable data alignment",useZabbixValueMapping:"Use Zabbix value mapping"}:this.target.queryType!==f.h&&this.target.queryType!==f.j||(e={sortProblems:"Sort problems",acknowledged:"Acknowledged",skipEmptyValues:"Skip empty values",hostsInMaintenance:"Show hosts in maintenance",limit:"Limit problems",hostProxy:"Show proxy",useTimeRange:"Use time range"});var t=[];return o.a.forOwn(this.target.options,(function(r,n){if(r&&e[n])if(!0===r)t.push(e[n]);else{var a=r;r&&r.text?a=r.text:r&&r.value&&(a=r.value),t.push(e[n]+" = "+a)}})),"Options: "+t.join(", ")},t.prototype.switchEditorMode=function(e){this.target.queryType=e,this.queryOptionsText=this.renderQueryOptionsText(),this.init(),this.targetChanged()},t.prototype.appFilterDisabled=function(){return!this.zabbix.supportsApplications()},t}(Fe.QueryCtrl),ze=r(0),Ue=r.n(ze),Qe=r(8),We=r(5),Xe=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ze=function(){return(Ze=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ye=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},Je=(null===(Ve=We.LegacyForms)||void 0===Ve?void 0:Ve.Input)||We.Input,Ke=RegExp("^"+p.x.source),et=((je={})[We.EventsWithValidation.onBlur]=[{rule:function(e){return!e||!(e.length>1&&"/"===e[0]&&"/"!==e[e.length-1])},errorMessage:"Not a valid regex"},{rule:function(e){return"*"!==e},errorMessage:"Wildcards not supported. Use /.*/ instead"}],je),tt=function(e){var t=e.value,r=(e.ref,e.validationEvents,Ye(e,["value","ref","validationEvents"])),n=function(e){return{inputRegex:Object(Qe.css)(Be||(Be=Xe(["\n    color: ","\n  "],["\n    color: ","\n  "])),e.palette.orange),inputVariable:Object(Qe.css)(He||(He=Xe(["\n    color: ","\n  "],["\n    color: ","\n  "])),e.colors.textBlue)}}(Object(We.useTheme)()),a=n.inputRegex;return Ke.test(t)?a=n.inputVariable:Object(p.m)(t)&&(a=n.inputRegex),Ue.a.createElement(Je,Ze({className:a,value:t,validationEvents:et},r))},rt=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),nt=function(){return(nt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},at=function(e){function t(t){var r=e.call(this,t)||this;if(r.queryTypes=[{value:Z.b.Group,label:"Group"},{value:Z.b.Host,label:"Host"},{value:Z.b.Application,label:"Application"},{value:Z.b.ItemTag,label:"Item tag"},{value:Z.b.Item,label:"Item"},{value:Z.b.ItemValues,label:"Item values"}],r.defaults={selectedQueryType:{value:Z.b.Group,label:"Group"},queryType:Z.b.Group,group:"/.*/",host:"",application:"",itemTag:"",item:""},r.handleQueryUpdate=function(e,t){var n=e.currentTarget.value;r.setState((function(e){var r=nt({},e);return r[t]=n,nt({},r)}))},r.handleQueryChange=function(){var e=r.state,t=e.queryType,n={queryType:t,group:e.group,host:e.host,application:e.application,itemTag:e.itemTag,item:e.item};r.props.onChange(n,"Zabbix - "+t)},r.handleQueryTypeChange=function(e){r.setState(nt(nt({},r.state),{selectedQueryType:e,queryType:e.value}));var t=r.state,n=t.group,a=t.host,i=t.application,o=t.itemTag,s=t.item,u=e.value,l={queryType:u,group:n,host:a,application:i,itemTag:o,item:s};r.props.onChange(l,"Zabbix - "+u)},r.props.query&&"string"==typeof r.props.query){var n=Object(p.s)(r.props.query),a=r.getSelectedQueryType(n.queryType);r.state=nt({selectedQueryType:a,legacyQuery:r.props.query},n)}else if(r.props.query){n=r.props.query,a=r.getSelectedQueryType(n.queryType);r.state=nt(nt(nt({},r.defaults),n),{selectedQueryType:a})}else r.state=r.defaults;return r}return rt(t,e),t.prototype.getSelectedQueryType=function(e){return this.queryTypes.find((function(t){return t.value===e}))},t.prototype.render=function(){var e,t=this,r=this.state,n=r.selectedQueryType,a=r.legacyQuery,i=r.group,o=r.host,s=r.application,u=r.itemTag,l=r.item,c=this.props.datasource,p=(null===(e=null==c?void 0:c.zabbix)||void 0===e?void 0:e.isZabbix54OrHigher())||!1;return Ue.a.createElement(Ue.a.Fragment,null,Ue.a.createElement("div",{className:"gf-form max-width-21"},Ue.a.createElement(We.InlineFormLabel,{width:10},"Query Type"),Ue.a.createElement(We.Select,{width:11,value:n,options:this.queryTypes,onChange:this.handleQueryTypeChange})),Ue.a.createElement("div",{className:"gf-form-inline"},Ue.a.createElement("div",{className:"gf-form max-width-30"},Ue.a.createElement(We.InlineFormLabel,{width:10},"Group"),Ue.a.createElement(tt,{value:i,onChange:function(e){return t.handleQueryUpdate(e,"group")},onBlur:this.handleQueryChange})),n.value!==Z.b.Group&&Ue.a.createElement("div",{className:"gf-form max-width-30"},Ue.a.createElement(We.InlineFormLabel,{width:10},"Host"),Ue.a.createElement(tt,{value:o,onChange:function(e){return t.handleQueryUpdate(e,"host")},onBlur:this.handleQueryChange}))),(n.value===Z.b.Application||n.value===Z.b.ItemTag||n.value===Z.b.Item||n.value===Z.b.ItemValues)&&Ue.a.createElement("div",{className:"gf-form-inline"},p&&Ue.a.createElement("div",{className:"gf-form max-width-30"},Ue.a.createElement(We.InlineFormLabel,{width:10},"Item tag"),Ue.a.createElement(tt,{value:u,onChange:function(e){return t.handleQueryUpdate(e,"itemTag")},onBlur:this.handleQueryChange})),!p&&Ue.a.createElement("div",{className:"gf-form max-width-30"},Ue.a.createElement(We.InlineFormLabel,{width:10},"Application"),Ue.a.createElement(tt,{value:s,onChange:function(e){return t.handleQueryUpdate(e,"application")},onBlur:this.handleQueryChange})),(n.value===Z.b.Item||n.value===Z.b.ItemValues)&&Ue.a.createElement("div",{className:"gf-form max-width-30"},Ue.a.createElement(We.InlineFormLabel,{width:10},"Item"),Ue.a.createElement(tt,{value:l,onChange:function(e){return t.handleQueryUpdate(e,"item")},onBlur:this.handleQueryChange}))),a&&Ue.a.createElement("div",{className:"gf-form"},Ue.a.createElement(We.InlineFormLabel,{width:10,tooltip:"Original query string, read-only"},"Legacy Query"),Ue.a.createElement(We.Input,{css:"",value:a,readOnly:!0})))},t}(ze.PureComponent),it=function(){return(it=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ot=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},st=We.LegacyForms.FormField,ut=We.LegacyForms.Switch,lt=["mysql","postgres","influxdb"],ct=function(e,t,r){return function(n){var a;r(it(it({},t),{jsonData:it(it({},t.jsonData),(a={},a[e]=n.currentTarget.value,a))}))}},pt=function(e,t,r){return function(n){var a;r(it(it({},t),{jsonData:it(it({},t.jsonData),(a={},a[e]=n.target.checked,a))}))}},ft=function(e,t,r){return function(n){var a;r(it(it({},t),{secureJsonData:it(it({},t.secureJsonData),(a={},a[e]=n.currentTarget.value,a))}))}},dt=function(e,t,r){return function(n){var a;r(it(it({},t),{secureJsonFields:it(it({},t.secureJsonFields),(a={},a[e]=!1,a))}))}},mt=function(e,t,r,n){return function(a){var i=ht().find((function(e){return e.id===a.value}));r({label:i.name,value:i.id}),n(i.type),t(it(it({},e),{jsonData:it(it({},e.jsonData),{dbConnectionDatasourceId:a.value})}))}},ht=function(){var e=Object(a.getDataSourceSrv)().getAll();return e=e.filter((function(e){return lt.includes(e.type)}))},gt=function(){return ht().map((function(e){return{label:e.name,value:e.id,description:e.type}}))},vt=r(44),yt=r.n(vt),bt=r(15),Et=r.n(bt);yt.a.module("grafana.directives").directive("addMetricFunction",["$compile",function(e){return{link:function(t,r){var n=T(),a=function(e){return o.a.reduce(e,(function(e,t){return o.a.each(t,(function(t){e.push(t.name)})),e}),[])}(n);t.functionMenu=function(e){return o.a.map(e,(function(e,t){return{text:t,submenu:o.a.map(e,(function(e){return{text:e.name,click:"ctrl.addFunction('"+e.name+"')"}}))}}))}(n);var i=Et()('<input type="text" class="gf-form-input" spellcheck="false" style="display:none"></input>'),s=Et()('<a  class="gf-form-label tight-form-func dropdown-toggle query-part" tabindex="1" gf-dropdown="functionMenu" data-toggle="dropdown"><i class="fa fa-plus"></i></a>');i.appendTo(r),s.appendTo(r),i.attr("data-provide","typeahead"),i.typeahead({source:a,minLength:1,items:10,updater:function(e){var r=function(e){return g[e]}(e);if(r||(e=e.toLowerCase(),r=o.a.find(a,(function(t){return 0===t.toLowerCase().indexOf(e)}))))return t.$apply((function(){t.ctrl.addFunction(r)})),i.trigger("blur"),""}}),s.click((function(){s.hide(),i.show(),i.focus()})),i.keyup((function(){r.toggleClass("open",""===i.val())})),i.blur((function(){setTimeout((function(){i.val(""),i.hide(),s.show(),r.removeClass("open")}),200)})),e(r.contents())(t)}}}]);var Tt=r(30),xt=r.n(Tt);var It=function(e){return e.description?Ue.a.createElement("span",{className:"pointer fa fa-question-circle",onClick:e.onDescriptionShow}):Ue.a.createElement("span",{className:"pointer fa fa-question-circle",onClick:function(){window.open("https://alexanderzobnin.github.io/grafana-zabbix/reference/functions/#"+e.name,"_blank")}})},wt=function(e){var t=e.func,r=e.onMoveLeft,n=e.onMoveRight,a=e.onRemove,i=e.onDescriptionShow;return Ue.a.createElement("div",{style:{display:"flex",width:"60px",justifyContent:"space-between"}},Ue.a.createElement("span",{className:"pointer fa fa-arrow-left",onClick:function(){return r(t)}}),Ue.a.createElement(It,{name:t.def.name,description:t.def.description,onDescriptionShow:i}),Ue.a.createElement("span",{className:"pointer fa fa-remove",onClick:function(){return a(t)}}),Ue.a.createElement("span",{className:"pointer fa fa-arrow-right",onClick:function(){return n(t)}}))},At=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),St=function(){return(St=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Pt=function(e){function t(t){var r=e.call(this,t)||this;return r.triggerRef=Ue.a.createRef(),r.renderContent=function(e){var t=e.updatePopperPosition,n=r.props,a=n.onMoveLeft,i=n.onMoveRight,o=n.func.def,s=o.name,u=o.description;return r.state.showingDescription?Ue.a.createElement("div",{style:{overflow:"auto",maxHeight:"30rem",textAlign:"left",fontWeight:"normal"}},Ue.a.createElement("h4",{style:{color:"white"}}," ",s," "),Ue.a.createElement("div",null,u)):Ue.a.createElement(wt,St({},r.props,{onMoveLeft:function(){a(r.props.func),t()},onMoveRight:function(){i(r.props.func),t()},onDescriptionShow:function(){r.setState({showingDescription:!0},(function(){t()}))}}))},r.state={showingDescription:!1},r}return At(t,e),t.prototype.render=function(){var e=this;return Ue.a.createElement(We.PopoverController,{content:this.renderContent,placement:"top",hideAfter:300},(function(t,r,n){return Ue.a.createElement(Ue.a.Fragment,null,e.triggerRef&&Ue.a.createElement(We.Popover,St({},n,{referenceElement:e.triggerRef.current,wrapperClassName:"popper",className:"popper__background",onMouseLeave:function(){e.setState({showingDescription:!1}),r()},onMouseEnter:t,renderArrow:function(e){var t=e.arrowProps,r=e.placement;return Ue.a.createElement("div",St({className:"popper__arrow","data-placement":r},t))}})),Ue.a.createElement("span",{ref:e.triggerRef,onClick:n.show?r:t,onMouseLeave:function(){r(),e.setState({showingDescription:!1})},style:{cursor:"pointer"}},e.props.func.def.name))}))},t}(Ue.a.PureComponent);function Dt(e,t){return{restrict:"A",link:function(r,n){var a=Et()('\n    <zbx-function-editor\n      func="func"\n      onRemove="ctrl.handleRemoveFunction"\n      onMoveLeft="ctrl.handleMoveLeft"\n      onMoveRight="ctrl.handleMoveRight">\n    </zbx-function-editor>\n    <span>(</span>\n  '),i=r.ctrl,s=r.func,u=!1,l=0,c=null;function p(e){var t=Et()(this),r=t.prev(".comma"),n=t.next();n.val(s.params[e]),r.removeClass("query-part__last"),t.hide(),n.show(),n.focus(),n.select();var a=n.data("typeahead");a&&(n.val(""),a.lookup())}function f(e){return e<s.def.params.length?s.def.params[e]:o.a.last(s.def.params).multiple?o.a.assign({},o.a.last(s.def.params),{optional:!0}):{}}function d(e,n){var a=Et()(e);clearTimeout(c),c=null;var o=a.prev(),p=o.prev(".comma"),d=a.val();(""!==d||f(n).optional)&&(s.updateParam(d,n),o.html(d?t.highlightVariablesAsHtml(d):"&nbsp;")),l!==s.params.length&&(u||(u=!0,setTimeout((function(){y(),u=!1}),200))),r.$apply((function(){i.targetChanged()})),o.hasClass("query-part__last")&&""===d?p.addClass("query-part__last"):o.removeClass("query-part__last"),a.hide(),o.show()}function m(e){var t=this;c=setTimeout((function(){d(t,e)}),200)}function h(e,t){13===t.which&&Et()(this).blur()}function g(){this.style.width=8*(3+this.value.length)+"px"}function v(){a.appendTo(n);for(var i=o.a.clone(s.def.params),u=o.a.last(s.def.params);s.params.length>=i.length&&u&&u.multiple;)i.push(o.a.assign({},u,{optional:!0}));o.a.each(i,(function(e,r){if(e.optional&&s.params.length<r)return!1;var a=t.highlightVariablesAsHtml(s.params[r]),i=null!=a,u=r>=s.params.length-1&&e.optional&&!i;u&&e.multiple&&(a="+"),r>0&&Et()('<span class="comma'+(u?" query-part__last":"")+'">,&nbsp; </span>').appendTo(n);var c=Et()('<a ng-click="" class="graphite-func-param-link'+(u?" query-part__last":"")+'">'+(i?a:"&nbsp;")+"</a>"),v=Et()('<input type="text" style="display:none" class="input-small tight-form-func-param"></input>');return v.attr("placeholder",e.name),l++,c.appendTo(n),v.appendTo(n),v.blur(o.a.partial(m,r)),v.keyup(g),v.keypress(o.a.partial(h,r)),c.click(o.a.partial(p,r)),e.options&&function(e,t){e.attr("data-provide","typeahead");var r=f(t).options;"int"!==f(t).type&&"float"!==f(t).type||(r=o.a.map(r,(function(e){return e.toString()}))),e.typeahead({source:r,minLength:0,items:20,updater:function(r){return e.val(r),d(e[0],t),r}}),e.data("typeahead").lookup=function(){return this.query=this.$element.val()||"",this.process(this.source)}}(v,r),!0})),Et()("<span>)</span>").appendTo(n),e(n.contents())(r)}function y(){n.children().remove(),v(),r.func.added&&(r.func.added=!1,setTimeout((function(){n.find(".graphite-func-param-link").first().click()}),10))}i.handleRemoveFunction=function(e){i.removeFunction(e)},i.handleMoveLeft=function(e){i.moveFunction(e,-1)},i.handleMoveRight=function(e){i.moveFunction(e,1)},y()}}}Dt.$inject=["$compile","templateSrv"],xt.a.directive("zabbixFunctionEditor",Dt),function(e,t,r){xt.a.directive(e,["reactDirective",function(e){return e(t,r)}])}("zbxFunctionEditor",Pt,["func","onRemove","onMoveLeft","onMoveRight"]),r.d(t,"plugin",(function(){return Rt}));var Ot=function(){function e(){}return e.templateUrl="datasource-zabbix/partials/annotations.editor.html",e}();Ge.templateUrl="datasource-zabbix/partials/query.editor.html",Object(a.loadPluginCss)({dark:"plugins/iiris-zabbix-triggers-panel/css/grafana-zabbix.dark.css",light:"plugins/iiris-zabbix-triggers-panel/css/grafana-zabbix.light.css"});var Rt=new n.DataSourcePlugin(De).setConfigEditor((function(e){var t,r,n=e.options,i=e.onOptionsChange,o=Object(ze.useState)(null),s=o[0],u=o[1],l=Object(ze.useState)(""),c=l[0],p=l[1];return Object(ze.useEffect)((function(){var e=n.jsonData,t=n.secureJsonFields,r=e.password,o=ot(e,["password"]);if((null==t?void 0:t.password)||(n.secureJsonData||(n.secureJsonData={}),n.secureJsonData.password=r),i(it(it({},n),{jsonData:it({trends:!0,trendsFrom:"",trendsRange:"",cacheTTL:"",timeout:void 0,disableDataAlignment:!1},o)})),n.jsonData.dbConnectionEnable)if(n.jsonData.dbConnectionDatasourceId){var s=ht().find((function(e){return e.id===n.jsonData.dbConnectionDatasourceId}));u({label:s.name,value:s.id}),p(s.type)}else{var l=n.jsonData.dbConnectionDatasourceName;Object(a.getDataSourceSrv)().get(l).then((function(e){if(e){var t=ht().find((function(t){return t.id===e.id}));u({label:t.name,value:t.id}),p(t.type),i(it(it({},n),{jsonData:it(it({},n.jsonData),{dbConnectionDatasourceId:e.id})}))}}))}}),[]),Ue.a.createElement(Ue.a.Fragment,null,Ue.a.createElement(We.DataSourceHttpSettings,{defaultUrl:"http://localhost/zabbix/api_jsonrpc.php",dataSourceConfig:n,showAccessOptions:!0,onChange:i}),Ue.a.createElement("div",{className:"gf-form-group"},Ue.a.createElement("h3",{className:"page-heading"},"Zabbix API details"),Ue.a.createElement("div",{className:"gf-form max-width-25"},Ue.a.createElement(st,{labelWidth:7,inputWidth:15,label:"Username",value:n.jsonData.username||"",onChange:ct("username",n,i),required:!0})),Ue.a.createElement("div",{className:"gf-form max-width-25"},(null===(t=n.secureJsonFields)||void 0===t?void 0:t.password)?Ue.a.createElement(Ue.a.Fragment,null,Ue.a.createElement(st,{labelWidth:7,inputWidth:15,label:"Password",disabled:!0,value:"",placeholder:"Configured"}),Ue.a.createElement(We.Button,{onClick:dt("password",n,i)},"Reset")):Ue.a.createElement(st,{labelWidth:7,inputWidth:15,label:"Password",type:"password",value:(null===(r=n.secureJsonData)||void 0===r?void 0:r.password)||n.jsonData.password||"",onChange:ft("password",n,i),required:!0})),Ue.a.createElement(ut,{label:"Trends",labelClass:"width-7",checked:n.jsonData.trends,onChange:pt("trends",n,i)}),n.jsonData.trends&&Ue.a.createElement(Ue.a.Fragment,null,Ue.a.createElement("div",{className:"gf-form"},Ue.a.createElement(st,{labelWidth:7,inputWidth:4,label:"After",value:n.jsonData.trendsFrom||"",placeholder:"7d",onChange:ct("trendsFrom",n,i),tooltip:"Time after which trends will be used.\n                  Best practice is to set this value to your history storage period (7d, 30d, etc)."})),Ue.a.createElement("div",{className:"gf-form"},Ue.a.createElement(st,{labelWidth:7,inputWidth:4,label:"Range",value:n.jsonData.trendsRange||"",placeholder:"4d",onChange:ct("trendsRange",n,i),tooltip:"Time range width after which trends will be used instead of history.\n                  It's better to set this value in range of 4 to 7 days to prevent loading large amount of history data."}))),Ue.a.createElement("div",{className:"gf-form"},Ue.a.createElement(st,{labelWidth:7,inputWidth:4,label:"Cache TTL",value:n.jsonData.cacheTTL||"",placeholder:"1h",onChange:ct("cacheTTL",n,i),tooltip:"Zabbix data source caches metric names in memory. Specify how often data will be updated."})),Ue.a.createElement("div",{className:"gf-form"},Ue.a.createElement(st,{labelWidth:7,inputWidth:4,type:"number",label:"Timeout",value:n.jsonData.timeout,onChange:function(e){i(it(it({},n),{jsonData:it(it({},n.jsonData),{timeout:parseInt(e.currentTarget.value,10)})}))},tooltip:"Zabbix API connection timeout in seconds. Default is 30."}))),Ue.a.createElement("div",{className:"gf-form-group"},Ue.a.createElement("h3",{className:"page-heading"},"Direct DB Connection"),Ue.a.createElement(ut,{label:"Enable",labelClass:"width-9",checked:n.jsonData.dbConnectionEnable,onChange:pt("dbConnectionEnable",n,i)}),n.jsonData.dbConnectionEnable&&Ue.a.createElement(Ue.a.Fragment,null,Ue.a.createElement("div",{className:"gf-form"},Ue.a.createElement(We.InlineFormLabel,{width:9},"Data Source"),Ue.a.createElement(We.Select,{width:32,options:gt(),value:s,onChange:mt(n,i,u,p)})),"influxdb"===c&&Ue.a.createElement("div",{className:"gf-form"},Ue.a.createElement(st,{labelWidth:9,inputWidth:16,label:"Retention Policy",value:n.jsonData.dbConnectionRetentionPolicy||"",placeholder:"Retention policy name",onChange:ct("dbConnectionRetentionPolicy",n,i),tooltip:"Specify retention policy name for fetching long-term stored data (optional).\n                    Leave it blank if only default retention policy used."})))),Ue.a.createElement("div",{className:"gf-form-group"},Ue.a.createElement("h3",{className:"page-heading"},"Other"),Ue.a.createElement(ut,{label:"Disable acknowledges for read-only users",labelClass:"width-16",checked:n.jsonData.disableReadOnlyUsersAck,onChange:pt("disableReadOnlyUsersAck",n,i)}),Ue.a.createElement(ut,{label:"Disable data alignment",labelClass:"width-16",checked:!!n.jsonData.disableDataAlignment,onChange:pt("disableDataAlignment",n,i),tooltip:"Data alignment feature aligns points based on item update interval.\n            For instance, if value collected once per minute, then timestamp of the each point will be set to the start of corresponding minute.\n            This alignment required for proper work of the stacked graphs.\n            If you don't need stacked graphs and want to get exactly the same timestamps as in Zabbix, then you can disable this feature."})))})).setQueryCtrl(Ge).setAnnotationQueryCtrl(Ot).setVariableQueryEditor(at)}])}));
//# sourceMappingURL=module.js.map